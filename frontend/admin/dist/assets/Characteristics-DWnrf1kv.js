import{b as je,a as Oe,_ as Le}from"./PageBreadcrumb.vue_vue_type_script_setup_true_lang-BDPjBQXm.js";import{o as y,c as _,b as e,r as v,a as ye,w as S,t as T,D as Pe,k as C,u as b,i as Q,j as Z,g as ge,d as F,n as D,v as X,e as H,p as z,E as pe,m as ne,G as Ae,F as W,f as le,y as Ue,C as He,z as ce,s as Me,H as Ie,B as Ee,A as De,I as ve}from"./index-Dl7gN0eW.js";import{_ as be,P as xe}from"./DeleteConfirmationModal-DOef7SCH.js";import{S as Te}from"./SearchIcon-Df8-ovyA.js";import{M as we}from"./Modal-2gPUZ4rE.js";import{_ as re}from"./Button.vue_vue_type_script_setup_true_lang-K0kTZ10j.js";import{_ as ke}from"./Pagination-B3GngO4J.js";import{a as me,C as Ve,E as Se,_ as Be,u as Ne}from"./useCategories-Tj7ujfAt.js";import"./useAuth-U_mOVBq3.js";const Re={},Fe={class:"fill-current",width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"};function ze(t,r){return y(),_("svg",Fe,r[0]||(r[0]=[e("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M6.54142 3.7915C6.54142 2.54886 7.54878 1.5415 8.79142 1.5415H11.2081C12.4507 1.5415 13.4581 2.54886 13.4581 3.7915V4.0415H15.6252H16.666C17.0802 4.0415 17.416 4.37729 17.416 4.7915C17.416 5.20572 17.0802 5.5415 16.666 4.7915H16.3752V8.24638V13.2464V16.2082C16.3752 17.4508 15.3678 18.4582 14.1252 18.4582H5.87516C4.63252 18.4582 3.62516 17.4508 3.62516 16.2082V13.2464V8.24638V5.5415H3.3335C2.91928 5.5415 2.5835 5.20572 2.5835 4.7915C2.5835 4.37729 2.91928 4.0415 3.3335 4.0415H4.37516H6.54142V3.7915ZM14.8752 13.2464V8.24638V5.5415H13.4581H12.7081H7.29142H6.54142H5.12516V8.24638V13.2464V16.2082C5.12516 16.6224 5.46095 16.9582 5.87516 16.9582H14.1252C14.5394 16.9582 14.8752 16.6224 14.8752 16.2082V13.2464ZM8.04142 4.0415H11.9581V3.7915C11.9581 3.37729 11.6223 3.0415 11.2081 3.0415H8.79142C8.37721 3.0415 8.04142 3.37729 8.04142 3.7915V4.0415ZM8.3335 7.99984C8.74771 7.99984 9.0835 8.33562 9.0835 8.74984V13.7498C9.0835 14.1641 8.74771 14.4998 8.3335 14.4998C7.91928 14.4998 7.5835 14.1641 7.5835 13.7498V8.74984C7.5835 8.33562 7.91928 7.99984 8.3335 7.99984ZM12.4168 8.74984C12.4168 8.33562 12.081 7.99984 11.6668 7.99984C11.2526 7.99984 10.9168 8.33562 10.9168 8.74984V13.7498C10.9168 14.1641 11.2526 14.4998 11.6668 14.4998C12.081 14.4998 12.4168 14.1641 12.4168 13.7498V8.74984Z",fill:""},null,-1)]))}const $e=je(Re,[["render",ze]]),Qe={},Ge={class:"fill-current",width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"};function qe(t,r){return y(),_("svg",Ge,r[0]||(r[0]=[e("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M15.0911 2.78206C14.2125 1.90338 12.7878 1.90338 11.9092 2.78206L4.57524 10.116C4.26682 10.4244 4.0547 10.8158 3.96468 11.2426L3.31231 14.3352C3.25997 14.5833 3.33653 14.841 3.51583 15.0203C3.69512 15.1996 3.95286 15.2761 4.20096 15.2238L7.29355 14.5714C7.72031 14.4814 8.11172 14.2693 8.42013 13.9609L15.7541 6.62695C16.6327 5.74827 16.6327 4.32365 15.7541 3.44497L15.0911 2.78206ZM12.9698 3.84272C13.2627 3.54982 13.7376 3.54982 14.0305 3.84272L14.6934 4.50563C14.9863 4.79852 14.9863 5.2734 14.6934 5.56629L14.044 6.21573L12.3204 4.49215L12.9698 3.84272ZM11.2597 5.55281L5.6359 11.1766C5.53309 11.2794 5.46238 11.4099 5.43238 11.5522L5.01758 13.5185L6.98394 13.1037C7.1262 13.0737 7.25666 13.003 7.35947 12.9002L12.9833 7.27639L11.2597 5.55281Z",fill:""},null,-1)]))}const _e=je(Qe,[["render",qe]]),Je={},Ze={xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"lucide lucide-image-icon lucide-image"};function Xe(t,r){return y(),_("svg",Ze,r[0]||(r[0]=[e("rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2"},null,-1),e("circle",{cx:"9",cy:"9",r:"2"},null,-1),e("path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21"},null,-1)]))}const We=je(Je,[["render",Xe]]);function Ke(){const t=v(!1),r=v(!1),a=v(null);return{showModal:t,isEditing:r,currentColor:a,openCreateModal:()=>{r.value=!1,a.value=null,t.value=!0},openEditModal:o=>{r.value=!0,a.value=o,t.value=!0},closeModal:()=>{t.value=!1,r.value=!1,a.value=null}}}function Ye(t={name:"",hex:"#000000"}){const r=v({...t});return{form:r,resetForm:()=>{r.value={name:"",hex:"#000000"}},setForm:l=>{r.value={...l}}}}function et(){const t=v([]);return{alerts:t,showAlert:(g,l,i)=>{const o={show:!0,type:g,title:l,message:i};t.value.push(o),setTimeout(()=>{const p=t.value.indexOf(o);p>-1&&t.value.splice(p,1)},3e3)},clearAlerts:()=>{t.value=[]}}}function tt(t){const r=ye({}),a=()=>{if(l()){r.name="";return}!t.value||!t.value.name||typeof t.value.name!="string"||!t.value.name.trim()?r.name="Название цвета обязательно.":t.value.name.length>255?r.name="Название цвета не должно превышать 255 символов.":r.name=""},g=()=>{if(l()){r.hex="";return}!t.value||!t.value.hex||typeof t.value.hex!="string"||!t.value.hex.trim()?r.hex="HEX код обязателен.":/^#[a-fA-F0-9]{6}$/.test(t.value.hex)?r.hex="":r.hex="HEX код должен быть в формате #RRGGBB."},l=()=>{var c,s;return!t.value||!((c=t.value.name)!=null&&c.trim())&&(t.value.hex==="#000000"||!((s=t.value.hex)!=null&&s.trim()))},i=()=>{k(),m=!1},o=()=>{l()||(a(),g())},p=()=>Object.values(r).some(u=>u);let m=!1;S(()=>{var u;return(u=t.value)==null?void 0:u.name},(u,c)=>{if(!m){m=!0;return}u!==c&&c!==void 0&&a()}),S(()=>{var u;return(u=t.value)==null?void 0:u.hex},(u,c)=>{m&&u!==c&&c!==void 0&&g()});const k=()=>{Object.keys(r).forEach(u=>{r[u]=""})};return{errors:r,validateAll:o,hasErrors:p,resetErrors:k,initializeValidation:i}}const rt={class:"border-t border-gray-100 dark:border-gray-800"},at={class:"py-3 whitespace-nowrap"},st={class:"flex items-center gap-3"},ot={class:"font-medium text-gray-800 text-theme-sm dark:text-white/90"},nt={class:"py-3 whitespace-nowrap"},lt={class:"text-gray-500 text-theme-sm dark:text-gray-400"},it={class:"py-3 whitespace-nowrap flex justify-center items-center"},dt=["aria-label"],ut={class:"py-3 whitespace-nowrap text-center"},ct=["aria-label"],gt=["aria-label"],pt={__name:"ColorRow",props:{color:{type:Object,required:!0}},emits:["edit","delete"],setup(t,{emit:r}){const a=r,g=i=>{a("edit",i)},l=i=>{a("delete",i)};return(i,o)=>(y(),_("tr",rt,[e("td",at,[e("div",st,[e("div",null,[e("p",ot,T(t.color.name),1)])])]),e("td",nt,[e("p",lt,T(t.color.hex),1)]),e("td",it,[e("div",{class:"w-8 h-8 rounded-full border border-gray-300 dark:border-gray-600",style:Pe({backgroundColor:t.color.hex}),"aria-label":`Цвет ${t.color.name} с кодом ${t.color.hex}`},null,12,dt)]),e("td",ut,[e("button",{class:"inline-flex items-center justify-center gap-2 rounded-lg transition shadow-theme-xs bg-white text-gray-700 ring-1 ring-gray-300 hover:bg-success-50 hover:ring-success-300 hover:text-success-700 dark:bg-gray-800 dark:text-gray-400 dark:ring-gray-700 dark:hover:bg-success-500/15 dark:hover:ring-success-500/50 dark:hover:text-success-500 cursor-pointer p-1 mr-3",onClick:o[0]||(o[0]=p=>g(t.color)),"aria-label":`Редактировать цвет ${t.color.name}`},[C(b(_e))],8,ct),e("button",{class:"inline-flex items-center justify-center gap-2 rounded-lg transition shadow-theme-xs bg-white text-gray-700 ring-1 ring-gray-300 hover:bg-error-50 hover:ring-error-300 hover:text-error-700 dark:bg-gray-800 dark:text-gray-400 dark:ring-gray-700 dark:hover:bg-error-500/15 dark:hover:ring-error-500/50 dark:hover:text-error-500 cursor-pointer p-1",onClick:o[1]||(o[1]=p=>l(t.color.id)),"aria-label":`Удалить цвет ${t.color.name}`},[C(b($e))],8,gt)])]))}},mt={class:"relative bg-white dark:bg-gray-800 rounded-xl shadow-lg max-w-md w-full mx-4"},ft={class:"p-6"},vt={class:"text-lg font-semibold text-gray-900 dark:text-white text-center mb-4"},ht={key:0,class:"mt-1.5 text-theme-xs text-error-500"},yt={class:"relative flex"},bt={key:0,class:"mt-1.5 text-theme-xs text-error-500"},xt={class:"flex justify-end gap-3 pt-4"},wt={__name:"ColorModal",props:{isVisible:{type:Boolean,default:!1},isEditing:{type:Boolean,default:!1},color:{type:Object,default:()=>({name:"",hex:"#000000"})},errors:{type:Object,default:()=>({})}},emits:["close","save","update:errors"],setup(t,{emit:r}){const a=t,g=r,l=v({name:"",hex:"#000000"}),i=v({}),o=k=>k?"dark:bg-dark-900 shadow-theme-xs focus:border-error-300 focus:ring-error-500/10 dark:focus:border-error-800 h-11 w-full rounded-lg border border-error-300 bg-transparent px-4 py-2.5 text-sm text-gray-800 placeholder:text-gray-400 focus:ring-3 focus:outline-hidden dark:border-error-700 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30 appearance-none":"dark:bg-dark-900 shadow-theme-xs focus:border-brand-300 focus:ring-brand-500/10 dark:focus:border-brand-800 h-11 w-full rounded-lg border border-gray-300 bg-transparent px-4 py-2.5 text-sm text-gray-800 placeholder:text-gray-400 focus:ring-3 focus:outline-hidden dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30 appearance-none";S(()=>a.isVisible,k=>{k?(a.isEditing&&a.color?l.value={...a.color}:l.value={name:"",hex:"#000000"},i.value={...a.errors}):(l.value={name:"",hex:"#000000"},i.value={})}),S(()=>a.errors,k=>{i.value={...k}},{deep:!0});const p=()=>{g("close")},m=()=>{g("save",l.value)};return(k,u)=>t.isVisible?(y(),Q(we,{key:0,onClose:p},{body:Z(()=>[e("div",mt,[e("div",ft,[e("h3",vt,T(t.isEditing?"Редактировать цвет":"Создать цвет"),1),e("form",{onSubmit:ge(m,["prevent"]),class:"space-y-4"},[e("div",null,[u[2]||(u[2]=e("label",{for:"nameColor",class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Название ",-1)),F(e("input",{type:"text",id:"nameColor","onUpdate:modelValue":u[0]||(u[0]=c=>l.value.name=c),required:"",class:D(o(i.value.name))},null,2),[[X,l.value.name]]),i.value.name?(y(),_("p",ht,T(i.value.name),1)):H("",!0)]),e("div",null,[u[3]||(u[3]=e("label",{for:"hex",class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," HEX код ",-1)),e("div",yt,[F(e("input",{type:"text",id:"hex","onUpdate:modelValue":u[1]||(u[1]=c=>l.value.hex=c),placeholder:"#000000",pattern:"^#[a-fA-F0-9]{6}$",required:"",class:D(o(i.value.hex))},null,2),[[X,l.value.hex]]),e("div",{class:"absolute right-2 top-1/2 -translate-y-1/2 w-8 h-8 rounded-full border border-gray-300 dark:border-gray-600",style:Pe({backgroundColor:l.value.hex})},null,4)]),i.value.hex?(y(),_("p",bt,T(i.value.hex),1)):H("",!0),u[4]||(u[4]=e("p",{class:"text-sm text-gray-500 dark:text-gray-400 mt-1"}," Введите HEX код цвета в формате #RRGGBB ",-1))]),e("div",xt,[C(re,{variant:"outline",onClick:p},{default:Z(()=>u[5]||(u[5]=[z("Отмена")])),_:1}),C(re,{variant:"primary",type:"submit"},{default:Z(()=>[z(T(t.isEditing?"Сохранить":"Создать"),1)]),_:1})])],32)])])]),_:1})):H("",!0)}},kt={class:"overflow-hidden rounded-2xl border border-gray-200 bg-white px-4 pb-3 pt-4 dark:border-gray-800 dark:bg-white/[0.03] sm:px-6"},$t={class:"flex flex-col md:gap-1 gap-3 mb-4 sm:flex-row sm:items-center sm:justify-between"},_t={class:"relative sm:w-auto sm:min-w-[240px]"},Ct={class:"absolute top-1/2 left-4 -translate-y-1/2 text-gray-500 dark:text-gray-400"},Et={class:"max-w-full overflow-x-auto custom-scrollbar"},jt={class:"min-w-full"},At={__name:"ColorsTable",emits:["update:searchQuery"],setup(t,{emit:r}){const a=xe,g=Te,l=pe("colorsData"),{colors:i,searchQuery:o,currentPage:p,totalPages:m,fetchColors:k,createColor:u,updateColor:c,deleteColor:s}=l,{showModal:f,isEditing:w,currentColor:d,openCreateModal:n,openEditModal:h,closeModal:$}=Ke(),P=E=>{q.value={},h(E)},{form:U}=Ye(),{alerts:B,showAlert:V}=et(),{validateAll:ae,hasErrors:te,resetErrors:K}=tt(U),q=v({}),G=v(!1),N=v(null),Y=()=>{o.value=""},se=E=>{E>=1&&E<=m.value&&k(E)},oe=E=>{N.value=E,G.value=!0},O=async E=>{var x,A;try{if(ae(),te())return;let M;if(w.value?M=await c(d.value.id,E):M=await u(E),M.success)V("success","Успешно",w.value?"Цвет успешно обновлён":"Цвет успешно создан"),await k(),$(),K();else{const j={};if(M.errors)for(const[R,ee]of Object.entries(M.errors))Array.isArray(ee)?j[R]=ee[0]:j[R]=ee;q.value=j;const L=Object.values(j);L.length>0?L.forEach(R=>{V("error","Ошибка валидации",R)}):V("error","Ошибка валидации",M.message||"Ошибка валидации")}}catch(M){const j=((A=(x=M.response)==null?void 0:x.data)==null?void 0:A.message)||"Не удалось сохранить цвет";V("error","Ошибка",j)}},I=async E=>{const x=i.value.find(A=>A.id===E);x&&oe(x)},J=async()=>{G.value=!1;try{await s(N.value.id),await k(),V("success","Успешно","Цвет успешно удалён")}catch(E){console.error("Error deleting color:",E),V("error","Ошибка","Не удалось удалить цвет")}};return(E,x)=>{var A,M;return y(),_(W,null,[e("div",kt,[e("div",$t,[e("div",_t,[e("span",Ct,[(y(),Q(ne(b(g))))]),x[3]||(x[3]=e("label",{for:"searchQuery"},null,-1)),F(e("input",{id:"searchQuery",type:"text",placeholder:"Поиск цвета...","onUpdate:modelValue":x[0]||(x[0]=j=>Ae(o)?o.value=j:null),class:"dark:bg-dark-900 shadow-theme-xs focus:border-brand-300 focus:ring-brand-500/10 dark:focus:border-brand-800 h-11 w-full rounded-lg border border-gray-300 bg-transparent py-2.5 pr-10 pl-10 text-sm text-gray-800 placeholder:text-gray-400 focus:ring-3 focus:outline-hidden dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30"},null,512),[[X,b(o)]]),b(o)?(y(),_("button",{key:0,onClick:Y,class:"absolute top-1/2 right-2 -translate-y-1/2 text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200 text-xl leading-none cursor-pointer bg-white dark:bg-gray-900 px-1 z-10"}," ✕ ")):H("",!0)]),e("button",{type:"button",class:"bg-brand-500 shadow-theme-xs hover:bg-brand-600 inline-flex items-center justify-center gap-1 rounded-lg px-3 py-3 text-sm font-medium text-white transition",onClick:x[1]||(x[1]=(...j)=>b(n)&&b(n)(...j)),"aria-label":"Добавить новый цвет"},[(y(),Q(ne(b(a)),{width:"20",height:"20"})),x[4]||(x[4]=z(" Добавить цвет "))])]),e("div",Et,[e("table",jt,[x[5]||(x[5]=e("thead",null,[e("tr",{class:"border-t border-gray-100 dark:border-gray-800"},[e("th",{class:"py-3 text-left"},[e("p",{class:"font-bold text-gray-500 text-theme-xs dark:text-gray-400"},"Цвет")]),e("th",{class:"py-3 text-left"},[e("p",{class:"font-bold text-gray-500 text-theme-xs dark:text-gray-400"},"HEX код ")]),e("th",{class:"py-3 text-center"},[e("p",{class:"font-bold text-gray-500 text-theme-xs dark:text-gray-400"},"Предпросмотр")]),e("th",{class:"py-3 text-center"},[e("p",{class:"font-bold text-gray-500 text-theme-xs dark:text-gray-400"},"Действие")])])],-1)),e("tbody",null,[(y(!0),_(W,null,le(b(i),j=>(y(),Q(pt,{key:j.id,color:j,onEdit:P,onDelete:I},null,8,["color"]))),128))])])]),C(ke,{"current-page":b(p),"total-pages":b(m),onPageChange:se},null,8,["current-page","total-pages"])]),C(wt,{"is-visible":b(f),"is-editing":b(w),color:b(d),errors:q.value,onClose:b($),onSave:O},null,8,["is-visible","is-editing","color","errors","onClose"]),C(me,{alerts:b(B)},null,8,["alerts"]),C(be,{isVisible:G.value,productName:(A=N.value)==null?void 0:A.name,productArticle:(M=N.value)==null?void 0:M.hex,onClose:x[2]||(x[2]=j=>G.value=!1),onConfirm:J},null,8,["isVisible","productName","productArticle"])],64)}}};function Mt(){const t=v(!1),r=v(!1),a=v({id:null,name:"",country:"",description:"",is_active:!0,image:""});return{showModal:t,isEditing:r,currentBrand:a,openCreateModal:()=>{r.value=!1,a.value={id:null,name:"",country:"",description:"",is_active:!0,image:""},t.value=!0},openEditModal:o=>{r.value=!0,a.value={...o},t.value=!0},closeModal:()=>{t.value=!1,r.value=!1,a.value={id:null,name:"",country:"",description:"",is_active:!0,image:""}}}}function Tt(){const t=v({name:"",country:"",description:"",is_active:!0,image:""});return{form:t,resetForm:()=>{t.value={name:"",country:"",description:"",is_active:!0,image:""}},setForm:g=>{t.value={...g}}}}function Pt(){const t=v([]);return{alerts:t,showAlert:(g,l,i)=>{const o={show:!0,type:g,title:l,message:i};t.value.push(o),setTimeout(()=>{const p=t.value.indexOf(o);p>-1&&t.value.splice(p,1)},3e3)},clearAlerts:()=>{t.value=[]}}}function Vt(t){const r=ye({}),a=()=>{if(o()){r.name="";return}!t.value||!t.value.name||typeof t.value.name!="string"||!t.value.name.trim()?r.name="Название бренда обязательно.":t.value.name.length>255?r.name="Название бренда не должно превышать 255 символов.":r.name=""},g=()=>{if(o()){r.country="";return}t.value&&t.value.country&&t.value.country.length>255?r.country="Страна не должна превышать 255 символов.":r.country=""},l=()=>{if(o()){r.description="";return}t.value&&t.value.description&&t.value.description.length>1e3?r.description="Описание не должно превышать 1000 символов.":r.description=""},i=()=>{if(o()){r.image="";return}t.value&&t.value.image&&!/^https?:\/\/.+/.test(t.value.image)?r.image="Ссылка на изображение должна быть валидным URL.":r.image=""},o=()=>{var f,w,d,n;return!t.value||!((f=t.value.name)!=null&&f.trim())&&!((w=t.value.country)!=null&&w.trim())&&!((d=t.value.description)!=null&&d.trim())&&!((n=t.value.image)!=null&&n.trim())},p=()=>{c(),u=!1},m=()=>{o()||(a(),g(),l(),i())},k=()=>Object.values(r).some(s=>s);let u=!1;S(()=>{var s;return(s=t.value)==null?void 0:s.name},(s,f)=>{if(!u){u=!0;return}s!==f&&f!==void 0&&a()}),S(()=>{var s;return(s=t.value)==null?void 0:s.country},(s,f)=>{u&&s!==f&&f!==void 0&&g()}),S(()=>{var s;return(s=t.value)==null?void 0:s.description},(s,f)=>{u&&s!==f&&f!==void 0&&l()}),S(()=>{var s;return(s=t.value)==null?void 0:s.image},(s,f)=>{u&&s!==f&&f!==void 0&&i()});const c=()=>{Object.keys(r).forEach(s=>{r[s]=""})};return{errors:r,validateAll:m,hasErrors:k,resetErrors:c,initializeValidation:p}}const St={class:"border-t border-gray-100 dark:border-gray-800"},Bt={class:"py-3 whitespace-nowrap"},Ot={class:"flex items-center gap-3"},Lt={class:"h-[32px] w-auto overflow-hidden rounded-md"},Ut=["src","alt"],Ht={key:1,class:"w-full h-full bg-gray-200 dark:bg-gray-700 flex items-center justify-center"},It={class:"font-medium text-gray-800 text-theme-sm dark:text-white/90"},Dt={class:"py-3 whitespace-nowrap"},Nt={class:"text-gray-500 text-theme-sm dark:text-gray-400"},Rt={class:"py-3 whitespace-nowrap"},Ft={key:0,class:"flex items-center justify-center w-6 h-6 bg-success-50 dark:bg-success-500/15 rounded-full"},zt={key:1,class:"flex items-center justify-center w-6 h-6 bg-error-50 dark:bg-error-500/15 rounded-full"},Qt={class:"py-3 whitespace-nowrap"},Gt={class:"py-3 whitespace-nowrap text-center"},qt=["aria-label"],Jt=["aria-label"],Zt={__name:"BrandRow",props:{brand:{type:Object,required:!0}},emits:["edit","delete"],setup(t,{emit:r}){const a="http://test.dennistp.beget.tech",g=r,l=p=>p.startsWith("http")?p:`${a}/storage/${p}`,i=p=>{g("edit",p)},o=p=>{g("delete",p)};return(p,m)=>(y(),_("tr",St,[e("td",Bt,[e("div",Ot,[e("div",Lt,[t.brand.image?(y(),_("img",{key:0,src:l(t.brand.image),alt:t.brand.name,class:"w-[70px] h-full object-contain dark:bg-white"},null,8,Ut)):(y(),_("div",Ht,[C(b(We),{class:"w-[70px] text-gray-500 dark:text-gray-400 text-sm"})]))]),e("div",null,[e("p",It,T(t.brand.name),1)])])]),e("td",Dt,[e("p",Nt,T(t.brand.country||"Не указано"),1)]),e("td",Rt,[t.brand.description?(y(),_("div",Ft,[C(b(Ve),{class:"w-4 h-4 text-success-600 dark:text-success-500"})])):(y(),_("div",zt,[C(b(Se),{class:"w-4 h-4 text-error-600 dark:text-error-500"})]))]),e("td",Qt,[e("span",{class:D({"rounded-full px-2 py-0.5 text-theme-xs font-medium":!0,"bg-success-50 text-success-600 dark:bg-success-500/15 dark:text-success-500":t.brand.is_active,"bg-error-50 text-error-600 dark:bg-error-500/15 dark:text-error-500":!t.brand.is_active})},T(t.brand.is_active?"Активен":"Неактивен"),3)]),e("td",Gt,[e("button",{class:"inline-flex items-center justify-center gap-2 rounded-lg transition shadow-theme-xs bg-white text-gray-700 ring-1 ring-gray-300 hover:bg-success-50 hover:ring-success-300 hover:text-success-700 dark:bg-gray-800 dark:text-gray-400 dark:ring-gray-700 dark:hover:bg-success-500/15 dark:hover:ring-success-500/50 dark:hover:text-success-500 cursor-pointer p-1 mr-3",onClick:m[0]||(m[0]=k=>i(t.brand)),"aria-label":`Редактировать бренд ${t.brand.name}`},[C(b(_e))],8,qt),e("button",{class:"inline-flex items-center justify-center gap-2 rounded-lg transition shadow-theme-xs bg-white text-gray-700 ring-1 ring-gray-300 hover:bg-error-50 hover:ring-error-300 hover:text-error-700 dark:bg-gray-800 dark:text-gray-400 dark:ring-gray-700 dark:hover:bg-error-500/15 dark:hover:ring-error-500/50 dark:hover:text-error-500 cursor-pointer p-1",onClick:m[1]||(m[1]=k=>o(t.brand.id)),"aria-label":`Удалить бренд ${t.brand.name}`},[C(b($e))],8,Jt)])]))}},Xt={class:"rounded-2xl border border-gray-200 bg-white dark:border-gray-800 dark:bg-white/[0.03]"},Wt={class:"p-4 sm:p-6"},Kt={key:0,class:"mb-4"},Yt={class:"relative group w-fit"},er=["src"],tr={key:1},rr={for:"brand-image",class:"shadow-theme-xs group hover:border-brand-500 block cursor-pointer rounded-lg border-2 border-dashed border-gray-300 transition dark:border-gray-800"},ar={key:2,class:"mt-4"},sr={class:"relative group w-fit"},or=["src"],nr=Ue({__name:"BrandImageUpload",props:{modelValue:{}},emits:["update:modelValue"],setup(t,{expose:r,emit:a}){const g=t,l=a,i=v(g.modelValue),o=v(null),p=v(null),m="http://test.dennistp.beget.tech";S(()=>g.modelValue,d=>{i.value=d}),S(i,d=>{l("update:modelValue",d)});const k=d=>d.startsWith("http")?d:`${m}/storage/${d}`,u=d=>window.URL.createObjectURL(d),c=(d,n,h)=>{p.value={show:!0,type:d,title:n,message:h},setTimeout(()=>{p.value=null},5e3)},s=d=>{const n=d.target,h=n.files;if(!h||h.length===0)return;const $=h[0],P=["image/png","image/jpeg","image/jpg","image/webp"],U=1*1024*1024;if(!P.includes($.type)){c("error","Неподдерживаемый формат","Файл имеет неподдерживаемый формат. Разрешены только PNG, JPG, JPEG, WEBP.");return}if($.size>U){c("error","Файл слишком большой","Файл слишком большой. Максимальный размер 1MB.");return}const B=new Image;B.onload=()=>{if(B.width>300||B.height>300){c("error","Изображение слишком большое","Максимальный размер изображения 300x300 пикселей.");return}o.value=$},B.src=window.URL.createObjectURL($),n.value=""},f=()=>{i.value=""},w=()=>{o.value=null};return r({newFile:o}),(d,n)=>(y(),_("div",Xt,[C(me,{alert:p.value},null,8,["alert"]),n[3]||(n[3]=e("div",{class:"border-b border-gray-200 px-6 py-4 dark:border-gray-800"},[e("h2",{class:"text-lg font-medium text-gray-800 dark:text-white"}," Фото бренда (макс. 1 изображение) ")],-1)),e("div",Wt,[i.value?(y(),_("div",Kt,[n[0]||(n[0]=e("h3",{class:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},"Текущее фото:",-1)),e("div",Yt,[e("img",{src:k(i.value),alt:"Фото бренда",class:"w-auto h-24 object-cover rounded-lg border border-gray-200"},null,8,er),e("button",{onClick:f,class:"absolute top-1 right-1 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",type:"button"}," × ")])])):H("",!0),i.value?H("",!0):(y(),_("div",tr,[e("label",rr,[n[1]||(n[1]=He('<div class="flex justify-center p-10"><div class="flex max-w-[260px] flex-col items-center gap-4"><div class="inline-flex h-13 w-13 items-center justify-center rounded-full border border-gray-200 text-gray-700 transition dark:border-gray-800 dark:text-gray-400"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"><path d="M20.0004 16V18.5C20.0004 19.3284 19.3288 20 18.5004 20H5.49951C4.67108 20 3.99951 19.3284 3.99951 18.5V16M12.0015 4L12.0015 16M7.37454 8.6246L11.9994 4.00269L16.6245 8.6246" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path></svg></div><p class="text-center text-sm text-gray-500 dark:text-gray-400"><span class="font-medium text-gray-800 dark:text-white/90">Щелкните, чтобы загрузить,</span> или перетащите PNG, JPG, JPEG или WEBP (макс. 300x300 пикселей) </p></div></div>',1)),e("input",{type:"file",id:"brand-image",class:"hidden",accept:".png,.jpg,.jpeg,.webp",onChange:s},null,32)])])),o.value?(y(),_("div",ar,[n[2]||(n[2]=e("h3",{class:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Новое фото для загрузки: ",-1)),e("div",sr,[e("img",{src:u(o.value),alt:"Новое фото бренда",class:"w-24 h-24 object-cover rounded-lg border border-gray-200"},null,8,or),e("button",{onClick:w,class:"absolute top-1 right-1 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",type:"button"}," × ")])])):H("",!0)])]))}}),lr={class:"relative bg-white dark:bg-gray-800 rounded-xl shadow-lg max-w-md w-full mx-4"},ir={class:"p-6"},dr={class:"text-lg font-semibold text-gray-900 dark:text-white text-center mb-4"},ur={key:0,class:"mt-1.5 text-theme-xs text-error-500"},cr={key:0,class:"mt-1.5 text-theme-xs text-error-500"},gr={key:0,class:"mt-1.5 text-theme-xs text-error-500"},pr={class:"flex justify-end gap-3 pt-4"},mr={__name:"BrandModal",props:{isVisible:{type:Boolean,default:!1},isEditing:{type:Boolean,default:!1},brand:{type:Object,default:()=>({name:"",country:"",description:"",is_active:!0,image:""})},errors:{type:Object,default:()=>({})}},emits:["close","save","update:errors"],setup(t,{emit:r}){const a=t,g=r,l=v(),i=v({name:"",country:"",description:"",is_active:!0,image:""}),o=v({}),p=c=>c?"dark:bg-dark-900 shadow-theme-xs focus:border-error-300 focus:ring-error-500/10 dark:focus:border-error-800 h-11 w-full rounded-lg border border-error-300 bg-transparent px-4 py-2.5 text-sm text-gray-800 placeholder:text-gray-400 focus:ring-3 focus:outline-hidden dark:border-error-700 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30 appearance-none":"dark:bg-dark-900 shadow-theme-xs focus:border-brand-300 focus:ring-brand-500/10 dark:focus:border-brand-800 h-11 w-full rounded-lg border border-gray-300 bg-transparent px-4 py-2.5 text-sm text-gray-800 placeholder:text-gray-400 focus:ring-3 focus:outline-hidden dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30 appearance-none",m=ce(()=>"dark:bg-dark-900 shadow-theme-xs focus:border-brand-300 focus:ring-brand-500/10 dark:focus:border-brand-800 w-full resize-none rounded-lg border border-gray-300 bg-transparent px-4 py-2.5 text-sm text-gray-800 placeholder:text-gray-400 focus:ring-3 focus:outline-hidden dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30");S(()=>a.isVisible,c=>{c?(a.isEditing&&a.brand?i.value={...a.brand}:i.value={name:"",country:"",description:"",is_active:!0,image:""},o.value={...a.errors}):(i.value={name:"",country:"",description:"",is_active:!0,image:""},o.value={})}),S(()=>a.errors,c=>{o.value={...c}},{deep:!0});const k=()=>{g("close")},u=()=>{var c;g("save",i.value,(c=l.value)==null?void 0:c.newFile)};return(c,s)=>t.isVisible?(y(),Q(we,{key:0,onClose:k},{body:Z(()=>[e("div",lr,[e("div",ir,[e("h3",dr,T(t.isEditing?"Редактировать бренд":"Создать бренд"),1),e("form",{onSubmit:ge(u,["prevent"]),class:"space-y-4"},[e("div",null,[s[5]||(s[5]=e("label",{for:"nameBrand",class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Название ",-1)),F(e("input",{type:"text",id:"nameBrand","onUpdate:modelValue":s[0]||(s[0]=f=>i.value.name=f),required:"",class:D(p(o.value.name))},null,2),[[X,i.value.name]]),o.value.name?(y(),_("p",ur,T(o.value.name),1)):H("",!0)]),e("div",null,[s[6]||(s[6]=e("label",{for:"country",class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Страна ",-1)),F(e("input",{type:"text",id:"country","onUpdate:modelValue":s[1]||(s[1]=f=>i.value.country=f),class:D(p(o.value.country))},null,2),[[X,i.value.country]]),o.value.country?(y(),_("p",cr,T(o.value.country),1)):H("",!0)]),e("div",null,[s[7]||(s[7]=e("label",{for:"description",class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Описание ",-1)),F(e("textarea",{id:"description","onUpdate:modelValue":s[2]||(s[2]=f=>i.value.description=f),rows:"3",class:D(m.value)},null,2),[[X,i.value.description]]),o.value.description?(y(),_("p",gr,T(o.value.description),1)):H("",!0)]),C(nr,{ref_key:"imageUploadRef",ref:l,modelValue:i.value.image,"onUpdate:modelValue":s[3]||(s[3]=f=>i.value.image=f)},null,8,["modelValue"]),C(Be,{id:"is_active",label:"Активен",checked:i.value.is_active,"onUpdate:checked":s[4]||(s[4]=f=>i.value.is_active=f)},null,8,["checked"]),e("div",pr,[C(re,{variant:"outline",onClick:k},{default:Z(()=>s[8]||(s[8]=[z("Отмена")])),_:1}),C(re,{variant:"primary",type:"submit"},{default:Z(()=>[z(T(t.isEditing?"Сохранить":"Создать"),1)]),_:1})])],32)])])]),_:1})):H("",!0)}},fr={class:"overflow-hidden rounded-2xl border border-gray-200 bg-white px-4 pb-3 pt-4 dark:border-gray-800 dark:bg-white/[0.03] sm:px-6"},vr={class:"flex flex-col md:gap-1 gap-3 mb-4 sm:flex-row sm:items-center sm:justify-between"},hr={class:"relative sm:w-auto sm:min-w-[240px]"},yr={class:"absolute top-1/2 left-4 -translate-y-1/2 text-gray-500 dark:text-gray-400"},br={class:"max-w-full overflow-x-auto custom-scrollbar"},xr={class:"min-w-full"},wr={__name:"BrandsTable",emits:["update:searchQuery"],setup(t,{emit:r}){const a=xe,g=Te,l=pe("brandsData"),{brands:i,searchQuery:o,currentPage:p,totalPages:m,fetchBrands:k,createBrand:u,updateBrand:c,deleteBrand:s}=l,{showModal:f,isEditing:w,currentBrand:d,openCreateModal:n,openEditModal:h,closeModal:$}=Mt(),P=x=>{G.value={},q(),h(x)},{form:U}=Tt(),{alerts:B,showAlert:V}=Pt(),{validateAll:ae,hasErrors:te,resetErrors:K,initializeValidation:q}=Vt(U),G=v({}),N=v(!1),Y=v(null),se=()=>{o.value=""},oe=x=>{x>=1&&x<=m.value&&k(x)},O=x=>{Y.value=x,N.value=!0},I=async(x,A)=>{var M,j;try{if(ae(),te())return;let L;if(w.value?L=await c(d.value.id,x,A):L=await u(x,A),L.success)V("success","Успешно",w.value?"Бренд успешно обновлён":"Бренд успешно создан"),await k(),$(),K();else{const R={};if(L.errors)for(const[fe,Ce]of Object.entries(L.errors))Array.isArray(Ce)?R[fe]=Ce[0]:R[fe]=Ce;G.value=R;const ee=Object.values(R);ee.length>0?ee.forEach(fe=>{V("error","Ошибка валидации",fe)}):V("error","Ошибка валидации",L.message||"Ошибка валидации")}}catch(L){console.error("Error saving brand:",L);const R=((j=(M=L.response)==null?void 0:M.data)==null?void 0:j.message)||"Не удалось сохранить бренд";V("error","Ошибка",R)}},J=async x=>{const A=i.value.find(M=>M.id===x);A&&O(A)},E=async()=>{N.value=!1;try{await s(Y.value.id),await k(),V("success","Успешно","Бренд успешно удалён")}catch(x){console.error("Error deleting brand:",x),V("error","Ошибка","Не удалось удалить бренд")}};return(x,A)=>{var M,j;return y(),_(W,null,[e("div",fr,[e("div",vr,[e("div",hr,[e("span",yr,[(y(),Q(ne(b(g))))]),A[3]||(A[3]=e("label",{for:"searchBrand"},null,-1)),F(e("input",{id:"searchBrand",type:"text",placeholder:"Поиск бренда...","onUpdate:modelValue":A[0]||(A[0]=L=>Ae(o)?o.value=L:null),class:"dark:bg-dark-900 shadow-theme-xs focus:border-brand-300 focus:ring-brand-500/10 dark:focus:border-brand-800 h-11 w-full rounded-lg border border-gray-300 bg-transparent py-2.5 pr-10 pl-10 text-sm text-gray-800 placeholder:text-gray-400 focus:ring-3 focus:outline-hidden dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30"},null,512),[[X,b(o)]]),b(o)?(y(),_("button",{key:0,onClick:se,class:"absolute top-1/2 right-2 -translate-y-1/2 text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200 text-xl leading-none cursor-pointer bg-white dark:bg-gray-900 px-1 z-10"}," ✕ ")):H("",!0)]),e("button",{type:"button",class:"bg-brand-500 shadow-theme-xs hover:bg-brand-600 inline-flex items-center justify-center gap-1 rounded-lg px-3 py-3 text-sm font-medium text-white transition",onClick:A[1]||(A[1]=(...L)=>b(n)&&b(n)(...L)),"aria-label":"Добавить новый бренд"},[(y(),Q(ne(b(a)),{width:"20",height:"20"})),A[4]||(A[4]=z(" Добавить бренд "))])]),e("div",br,[e("table",xr,[A[5]||(A[5]=e("thead",null,[e("tr",{class:"border-t border-gray-100 dark:border-gray-800"},[e("th",{class:"py-3 text-left"},[e("p",{class:"font-bold text-gray-500 text-theme-xs dark:text-gray-400"},"Бренд")]),e("th",{class:"py-3 text-left"},[e("p",{class:"font-bold text-gray-500 text-theme-xs dark:text-gray-400"},"Страна")]),e("th",{class:"py-3 text-left"},[e("p",{class:"font-bold text-gray-500 text-theme-xs dark:text-gray-400"},"Описание")]),e("th",{class:"py-3 text-left"},[e("p",{class:"font-bold text-gray-500 text-theme-xs dark:text-gray-400"},"Статус")]),e("th",{class:"py-3 text-center"},[e("p",{class:"font-bold text-gray-500 text-theme-xs dark:text-gray-400"},"Действие")])])],-1)),e("tbody",null,[(y(!0),_(W,null,le(b(i),L=>(y(),Q(Zt,{key:L.id,brand:L,onEdit:P,onDelete:J},null,8,["brand"]))),128))])])]),C(ke,{"current-page":b(p),"total-pages":b(m),onPageChange:oe},null,8,["current-page","total-pages"])]),C(mr,{"is-visible":b(f),"is-editing":b(w),brand:b(d),errors:G.value,onClose:b($),onSave:I},null,8,["is-visible","is-editing","brand","errors","onClose"]),C(me,{alerts:b(B)},null,8,["alerts"]),C(be,{isVisible:N.value,productName:(M=Y.value)==null?void 0:M.name,productArticle:(j=Y.value)==null?void 0:j.slug,onClose:A[2]||(A[2]=L=>N.value=!1),onConfirm:E},null,8,["isVisible","productName","productArticle"])],64)}}};function kr(){const t=v(!1),r=v(!1),a=v(null);return{showModal:t,isEditing:r,currentAttribute:a,openCreateModal:()=>{r.value=!1,a.value=null,t.value=!0},openEditModal:o=>{r.value=!0,a.value=o,t.value=!0},closeModal:()=>{t.value=!1,r.value=!1,a.value=null}}}function $r(t={name:"",type:""}){const r=v({...t});return{form:r,resetForm:()=>{r.value={name:"",type:""}},setForm:l=>{r.value={...l}}}}function _r(){const t=v([]);return{alerts:t,showAlert:(g,l,i)=>{const o={show:!0,type:g,title:l,message:i};t.value.push(o),setTimeout(()=>{const p=t.value.indexOf(o);p>-1&&t.value.splice(p,1)},3e3)},clearAlerts:()=>{t.value=[]}}}function Cr(t){const r=ye({}),a=()=>{if(l()){r.name="";return}!t.value||!t.value.name||typeof t.value.name!="string"||!t.value.name.trim()?r.name="Название атрибута обязательно.":t.value.name.length>255?r.name="Название атрибута не должно превышать 255 символов.":r.name=""},g=()=>{if(l()){r.type="";return}!t.value||!t.value.type||typeof t.value.type!="string"||!t.value.type.trim()?r.type="Тип атрибута обязателен.":r.type=""},l=()=>{var c,s;return!t.value||!((c=t.value.name)!=null&&c.trim())&&!((s=t.value.type)!=null&&s.trim())},i=()=>{k(),m=!1},o=()=>{l()||(a(),g())},p=()=>Object.values(r).some(u=>u);let m=!1;S(()=>{var u;return(u=t.value)==null?void 0:u.name},(u,c)=>{if(!m){m=!0;return}u!==c&&c!==void 0&&a()}),S(()=>{var u;return(u=t.value)==null?void 0:u.type},(u,c)=>{m&&u!==c&&c!==void 0&&g()});const k=()=>{Object.keys(r).forEach(u=>{r[u]=""})};return{errors:r,validateAll:o,hasErrors:p,resetErrors:k,initializeValidation:i}}const Er={class:"border-t border-gray-100 dark:border-gray-800"},jr={class:"py-3 whitespace-nowrap"},Ar={class:"flex items-center gap-3"},Mr={class:"font-medium text-gray-800 text-theme-sm dark:text-white/90"},Tr={class:"py-3 whitespace-nowrap"},Pr={class:"py-3 whitespace-nowrap text-center"},Vr={class:"text-sm text-gray-700 dark:text-gray-300"},Sr={class:"py-3 whitespace-nowrap"},Br={class:"flex flex-wrap gap-1"},Or={class:"py-3 whitespace-nowrap text-center"},Lr=["aria-label"],Ur=["aria-label"],Hr={__name:"AttributeRow",props:{attribute:{type:Object,required:!0}},emits:["edit","delete"],setup(t,{emit:r}){const a=t,g=ce(()=>({text:"Текст",string:"Строка",number:"Число",boolean:"Да/Нет",select:"Выбор"})[a.attribute.type]||a.attribute.type),l=ce(()=>({text:"inline-flex items-center px-2.5 py-0.5 justify-center gap-1 rounded-full capitalize bg-blue-light-50 text-blue-light-500 dark:bg-blue-light-500/15 dark:text-blue-light-500",boolean:"inline-flex items-center px-2.5 py-0.5 justify-center gap-1 rounded-full capitalize bg-brand-50 text-brand-500 dark:bg-brand-500/15 dark:text-brand-400",number:"inline-flex items-center px-2.5 py-0.5 justify-center gap-1 rounded-full capitalize bg-success-50 text-success-600 dark:bg-success-500/15 dark:text-success-500",string:"inline-flex items-center px-2.5 py-0.5 justify-center gap-1 rounded-full capitalize bg-warning-50 text-warning-600 dark:bg-warning-500/15 dark:text-orange-400",select:"inline-flex items-center px-2.5 py-0.5 justify-center gap-1 rounded-full capitalize bg-gray-100 text-gray-700 dark:bg-white/5 dark:text-white/80"})[a.attribute.type]||"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200"),i=r,o=m=>{i("edit",m)},p=m=>{i("delete",m)};return(m,k)=>(y(),_("tr",Er,[e("td",jr,[e("div",Ar,[e("div",null,[e("p",Mr,T(t.attribute.name),1)])])]),e("td",Tr,[e("span",{class:D([l.value,"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium"])},T(g.value),3)]),e("td",Pr,[e("span",Vr,T(t.attribute.unit||"—"),1)]),e("td",Sr,[e("div",Br,[(y(!0),_(W,null,le(t.attribute.categories,u=>(y(),_("span",{key:u.id,class:"inline-flex items-center px-2.5 py-0.5 justify-center gap-1 rounded-full font-medium capitalize text-xs bg-blue-light-50 text-blue-light-500 dark:bg-blue-light-500/15 dark:text-blue-light-500"},T(u.name),1))),128))])]),e("td",Or,[e("button",{class:"inline-flex items-center justify-center gap-2 rounded-lg transition shadow-theme-xs bg-white text-gray-700 ring-1 ring-gray-300 hover:bg-success-50 hover:ring-success-300 hover:text-success-700 dark:bg-gray-800 dark:text-gray-400 dark:ring-gray-700 dark:hover:bg-success-500/15 dark:hover:ring-success-500/50 dark:hover:text-success-500 cursor-pointer p-1 mr-3",onClick:k[0]||(k[0]=u=>o(t.attribute)),"aria-label":`Редактировать атрибут ${t.attribute.name}`},[C(b(_e))],8,Lr),e("button",{class:"inline-flex items-center justify-center gap-2 rounded-lg transition shadow-theme-xs bg-white text-gray-700 ring-1 ring-gray-300 hover:bg-error-50 hover:ring-error-300 hover:text-error-700 dark:bg-gray-800 dark:text-gray-400 dark:ring-gray-700 dark:hover:bg-error-500/15 dark:hover:ring-error-500/50 dark:hover:text-error-500 cursor-pointer p-1",onClick:k[1]||(k[1]=u=>p(t.attribute.id)),"aria-label":`Удалить атрибут ${t.attribute.name}`},[C(b($e))],8,Ur)])]))}},Ir={class:"relative w-full"},Dr={key:0,class:"text-gray-400 dark:text-gray-500"},Nr={key:1,class:"flex flex-wrap items-center flex-auto gap-2"},Rr=["onClick"],Fr={key:0,class:"absolute z-10 mt-1 w-full bg-white border border-gray-300 rounded-lg shadow-lg dark:bg-gray-800 dark:border-gray-600 max-h-60 overflow-y-auto"},zr=["onClick"],Qr={__name:"MultiSelect",props:{modelValue:{type:Array,default:()=>[]},options:{type:Array,default:()=>[]},placeholder:{type:String,default:"Выберите элементы..."}},emits:["update:modelValue"],setup(t,{emit:r}){const a=t,g=r,l=v(!1),i=v([...a.modelValue]),o=ce(()=>a.options.filter(c=>!i.value.some(s=>s.id===c.id)));S(()=>a.modelValue,c=>{i.value=[...c]},{immediate:!0});const p=()=>{l.value=!l.value},m=c=>{i.value.push(c),g("update:modelValue",i.value),l.value=!1},k=c=>{i.value=i.value.filter(s=>s.id!==c),g("update:modelValue",i.value)},u=c=>{c.target.closest(".relative")||(l.value=!1)};return Me(()=>{document.addEventListener("click",u)}),Ie(()=>{document.removeEventListener("click",u)}),(c,s)=>(y(),_("div",Ir,[e("div",{class:D(["dark:bg-dark-900 min-h-11 flex items-center w-full appearance-none rounded-lg border border-gray-300 bg-transparent bg-none px-4 py-2.5 text-sm text-gray-800 shadow-theme-xs placeholder:text-gray-400 focus:border-brand-300 focus:outline-hidden focus:ring-3 focus:ring-brand-500/10 dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30 dark:focus:border-brand-800",{"flex-wrap":i.value.length>0}]),onClick:p},[i.value.length===0?(y(),_("div",Dr,T(t.placeholder),1)):(y(),_("div",Nr,[(y(!0),_(W,null,le(i.value,f=>(y(),_("div",{key:f.id,class:"group flex items-center justify-center h-[30px] rounded-full border-[0.7px] border-transparent bg-gray-100 py-1 pl-2.5 pr-2 text-sm text-gray-800 hover:border-gray-200 dark:bg-gray-800 dark:text-white/90 dark:hover:border-gray-800"},[e("span",null,T(f.name),1),e("button",{class:"pl-2 text-gray-500 cursor-pointer group-hover:text-gray-400 dark:text-gray-400",onClick:ge(w=>k(f.id),["stop"]),"aria-label":"Remove item"},s[0]||(s[0]=[e("svg",{role:"button",width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M3.40717 4.46881C3.11428 4.17591 3.11428 3.70104 3.40717 3.40815C3.70006 3.11525 4.17494 3.11525 4.46783 3.40815L6.99943 5.93975L9.53095 3.40822C9.82385 3.11533 10.2987 3.11533 10.5916 3.40822C10.8845 3.70112 10.8845 4.17599 10.5916 4.46888L8.06009 7.00041L10.5916 9.53193C10.8845 9.82482 10.8845 10.2997 10.5916 10.5926C10.2987 10.8855 9.82385 10.8855 9.53095 10.5926L6.99943 8.06107L4.46783 10.5927C4.17494 10.8856 3.70006 10.8856 3.40717 10.5927C3.11428 10.2998 3.11428 9.8249 3.40717 9.53201L5.93877 7.00041L3.40717 4.46881Z",fill:"currentColor"})],-1)]),8,Rr)]))),128))])),s[1]||(s[1]=e("svg",{class:"ml-auto",width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M4.79175 7.39551L10.0001 12.6038L15.2084 7.39551",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"})],-1))],2),l.value?(y(),_("div",Fr,[(y(!0),_(W,null,le(o.value,f=>(y(),_("div",{key:f.id,class:"px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 cursor-pointer",onClick:w=>m(f)},T(f.name),9,zr))),128))])):H("",!0)]))}},Gr={class:"relative bg-white dark:bg-gray-800 rounded-xl shadow-lg max-w-md w-full mx-4"},qr={class:"p-6"},Jr={class:"text-lg font-semibold text-gray-900 dark:text-white text-center mb-4"},Zr={key:0,class:"mt-1.5 text-theme-xs text-error-500"},Xr={class:"flex space-x-6"},Wr={for:"form-unit1",class:"flex cursor-pointer items-center text-sm font-medium text-gray-700 select-none dark:text-gray-400"},Kr={for:"form-unit2",class:"flex cursor-pointer items-center text-sm font-medium text-gray-700 select-none dark:text-gray-400"},Yr={for:"form-unit3",class:"flex cursor-pointer items-center text-sm font-medium text-gray-700 select-none dark:text-gray-400"},ea={key:0,class:"mt-1.5 text-theme-xs text-error-500"},ta={key:0,class:"mt-1.5 text-theme-xs text-error-500"},ra={class:"flex justify-end gap-3 pt-4"},aa={__name:"AttributeModal",props:{isVisible:{type:Boolean,default:!1},isEditing:{type:Boolean,default:!1},attribute:{type:Object,default:()=>({name:"",type:""})},errors:{type:Object,default:()=>({})}},emits:["close","save","update:errors"],setup(t,{emit:r}){const a=t,g=r,{flatCategories:l,fetchCategories:i}=Ne(),o=v({name:"",type:"",categories:[],unit:""}),p=v({}),m=c=>c?"dark:bg-dark-900 shadow-theme-xs focus:border-error-300 focus:ring-error-500/10 dark:focus:border-error-800 h-11 w-full rounded-lg border border-error-300 bg-transparent px-4 py-2.5 text-sm text-gray-800 placeholder:text-gray-400 focus:ring-3 focus:outline-hidden dark:border-error-700 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30 appearance-none":"dark:bg-dark-900 shadow-theme-xs focus:border-brand-300 focus:ring-brand-500/10 dark:focus:border-brand-800 h-11 w-full rounded-lg border border-gray-300 bg-transparent px-4 py-2.5 text-sm text-gray-800 placeholder:text-gray-400 focus:ring-3 focus:outline-hidden dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30 appearance-none";S(()=>a.isVisible,async c=>{c?(await i(),a.isEditing&&a.attribute?o.value={...a.attribute,categories:a.attribute.categories||[],unit:a.attribute.unit||""}:o.value={name:"",type:"",categories:[],unit:""},p.value={...a.errors}):(o.value={name:"",type:"",categories:[],unit:""},p.value={})}),Me(async()=>{await i()}),S(()=>a.errors,c=>{p.value={...c}},{deep:!0});const k=()=>{g("close")},u=()=>{const c={...o.value,categories:o.value.categories.map(s=>s.id)};g("save",c)};return(c,s)=>t.isVisible?(y(),Q(we,{key:0,onClose:k},{body:Z(()=>[e("div",Gr,[e("div",qr,[e("h3",Jr,T(t.isEditing?"Редактировать атрибут":"Создать атрибут"),1),e("form",{onSubmit:ge(u,["prevent"]),class:"space-y-4"},[e("div",null,[s[6]||(s[6]=e("label",{for:"nameAttribute",class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Название ",-1)),F(e("input",{type:"text",id:"nameAttribute","onUpdate:modelValue":s[0]||(s[0]=f=>o.value.name=f),required:"",class:D(m(p.value.name))},null,2),[[X,o.value.name]]),p.value.name?(y(),_("p",Zr,T(p.value.name),1)):H("",!0)]),e("div",null,[s[10]||(s[10]=e("div",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},"Единица измерения",-1)),e("div",Xr,[e("label",Wr,[F(e("input",{id:"form-unit1",type:"radio","onUpdate:modelValue":s[1]||(s[1]=f=>o.value.unit=f),value:"кг",class:"sr-only"},null,512),[[Ee,o.value.unit]]),e("div",{class:D([o.value.unit==="кг"?"border-brand-500 bg-brand-500":"bg-transparent border-gray-300 dark:border-gray-700","hover:border-brand-500 dark:hover:border-brand-500 mr-3 flex h-5 w-5 items-center justify-center rounded-full border-[1.25px]"])},[e("span",{class:D([o.value.unit==="кг"?"":"opacity-0","h-2 w-2 rounded-full bg-white"])},null,2)],2),s[7]||(s[7]=z(" кг "))]),e("label",Kr,[F(e("input",{id:"form-unit2",type:"radio","onUpdate:modelValue":s[2]||(s[2]=f=>o.value.unit=f),value:"мм",class:"sr-only"},null,512),[[Ee,o.value.unit]]),e("div",{class:D([o.value.unit==="мм"?"border-brand-500 bg-brand-500":"bg-transparent border-gray-300 dark:border-gray-700","hover:border-brand-500 dark:hover:border-brand-500 mr-3 flex h-5 w-5 items-center justify-center rounded-full border-[1.25px]"])},[e("span",{class:D([o.value.unit==="мм"?"":"opacity-0","h-2 w-2 rounded-full bg-white"])},null,2)],2),s[8]||(s[8]=z(" мм "))]),e("label",Yr,[F(e("input",{id:"form-unit3",type:"radio","onUpdate:modelValue":s[3]||(s[3]=f=>o.value.unit=f),value:"",class:"sr-only"},null,512),[[Ee,o.value.unit]]),e("div",{class:D([o.value.unit===""?"border-brand-500 bg-brand-500":"bg-transparent border-gray-300 dark:border-gray-700","hover:border-brand-500 dark:hover:border-brand-500 mr-3 flex h-5 w-5 items-center justify-center rounded-full border-[1.25px]"])},[e("span",{class:D([o.value.unit===""?"":"opacity-0","h-2 w-2 rounded-full bg-white"])},null,2)],2),s[9]||(s[9]=z(" нет "))])])]),e("div",null,[s[12]||(s[12]=e("label",{for:"type",class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Тип ",-1)),F(e("select",{id:"type","onUpdate:modelValue":s[4]||(s[4]=f=>o.value.type=f),required:"",class:D(m(p.value.type))},s[11]||(s[11]=[e("option",{value:""},"Выберите тип",-1),e("option",{value:"string"},"Текст",-1),e("option",{value:"number"},"Число",-1),e("option",{value:"boolean"},"Да/Нет",-1),e("option",{value:"select"},"Выбор",-1)]),2),[[De,o.value.type]]),p.value.type?(y(),_("p",ea,T(p.value.type),1)):H("",!0)]),e("div",null,[s[13]||(s[13]=e("p",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Категории ",-1)),C(Qr,{modelValue:o.value.categories,"onUpdate:modelValue":s[5]||(s[5]=f=>o.value.categories=f),options:b(l),placeholder:"Выберите категории..."},null,8,["modelValue","options"]),p.value.categories?(y(),_("p",ta,T(p.value.categories),1)):H("",!0)]),e("div",ra,[C(re,{variant:"outline",onClick:k},{default:Z(()=>s[14]||(s[14]=[z("Отмена")])),_:1}),C(re,{variant:"primary",type:"submit"},{default:Z(()=>[z(T(t.isEditing?"Сохранить":"Создать"),1)]),_:1})])],32)])])]),_:1})):H("",!0)}},sa={class:"overflow-hidden rounded-2xl border border-gray-200 bg-white px-4 pb-3 pt-4 dark:border-gray-800 dark:bg-white/[0.03] sm:px-6"},oa={class:"flex flex-col md:gap-1 gap-3 mb-4 sm:flex-row sm:items-center sm:justify-between"},na={class:"relative sm:w-auto sm:min-w-[240px]"},la={class:"absolute top-1/2 left-4 -translate-y-1/2 text-gray-500 dark:text-gray-400"},ia={class:"max-w-full overflow-x-auto custom-scrollbar"},da={class:"min-w-full"},ua={__name:"AttributesTable",emits:["update:searchQuery"],setup(t,{emit:r}){const a=xe,g=Te,l=pe("attributesData"),{attributes:i,searchQuery:o,currentPage:p,totalPages:m,fetchAttributes:k,createAttribute:u,updateAttribute:c,deleteAttribute:s}=l,{showModal:f,isEditing:w,currentAttribute:d,openCreateModal:n,openEditModal:h,closeModal:$}=kr(),P=E=>{q.value={},h(E)},{form:U}=$r(),{alerts:B,showAlert:V}=_r(),{validateAll:ae,hasErrors:te,resetErrors:K}=Cr(U),q=v({}),G=v(!1),N=v(null),Y=()=>{o.value=""},se=E=>{E>=1&&E<=m.value&&k(E)},oe=E=>{N.value=E,G.value=!0},O=async E=>{var x,A;try{if(ae(),te())return;let M;if(w.value?M=await c(d.value.id,E):M=await u(E),M.success)V("success","Успешно",w.value?"Атрибут успешно обновлён":"Атрибут успешно создан"),await k(),$(),K();else{const j={};if(M.errors)for(const[R,ee]of Object.entries(M.errors))Array.isArray(ee)?j[R]=ee[0]:j[R]=ee;q.value=j;const L=Object.values(j);L.length>0?L.forEach(R=>{V("error","Ошибка валидации",R)}):V("error","Ошибка валидации",M.message||"Ошибка валидации")}}catch(M){console.error("Error saving attribute:",M);const j=((A=(x=M.response)==null?void 0:x.data)==null?void 0:A.message)||"Не удалось сохранить атрибут";V("error","Ошибка",j)}},I=async E=>{const x=i.value.find(A=>A.id===E);x&&oe(x)},J=async()=>{G.value=!1;try{await s(N.value.id),await k(),V("success","Успешно","Атрибут успешно удалён")}catch(E){console.error("Error deleting attribute:",E),V("error","Ошибка","Не удалось удалить атрибут")}};return(E,x)=>{var A,M;return y(),_(W,null,[e("div",sa,[e("div",oa,[e("div",na,[e("span",la,[(y(),Q(ne(b(g))))]),x[3]||(x[3]=e("label",{for:"searchAttribute"},null,-1)),F(e("input",{id:"searchAttribute",type:"text",placeholder:"Поиск атрибута...","onUpdate:modelValue":x[0]||(x[0]=j=>Ae(o)?o.value=j:null),class:"dark:bg-dark-900 shadow-theme-xs focus:border-brand-300 focus:ring-brand-500/10 dark:focus:border-brand-800 h-11 w-full rounded-lg border border-gray-300 bg-transparent py-2.5 pr-10 pl-10 text-sm text-gray-800 placeholder:text-gray-400 focus:ring-3 focus:outline-hidden dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30"},null,512),[[X,b(o)]]),b(o)?(y(),_("button",{key:0,onClick:Y,class:"absolute top-1/2 right-2 -translate-y-1/2 text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200 text-xl leading-none cursor-pointer bg-white dark:bg-gray-900 px-1 z-10"}," ✕ ")):H("",!0)]),e("button",{type:"button",class:"bg-brand-500 shadow-theme-xs hover:bg-brand-600 inline-flex items-center justify-center gap-1 rounded-lg px-3 py-3 text-sm font-medium text-white transition",onClick:x[1]||(x[1]=(...j)=>b(n)&&b(n)(...j)),"aria-label":"Добавить новый атрибут"},[(y(),Q(ne(b(a)),{width:"20",height:"20"})),x[4]||(x[4]=z(" Добавить атрибут "))])]),e("div",ia,[e("table",da,[x[5]||(x[5]=e("thead",null,[e("tr",{class:"border-t border-gray-100 dark:border-gray-800"},[e("th",{class:"py-3 text-left w-1/12"},[e("p",{class:"font-bold text-gray-500 text-theme-xs dark:text-gray-400"},"Атрибут")]),e("th",{class:"py-3 text-left w-1/12"},[e("p",{class:"font-bold text-gray-500 text-theme-xs dark:text-gray-400"},"Тип")]),e("th",{class:"py-3 text-center w-1/12"},[e("p",{class:"font-bold text-gray-500 text-theme-xs dark:text-gray-400"},"Единица")]),e("th",{class:"py-3 text-center w-3/12"},[e("p",{class:"font-bold text-gray-500 text-theme-xs dark:text-gray-400"},"Категории")]),e("th",{class:"py-3 text-center w-1/12"},[e("p",{class:"font-bold text-gray-500 text-theme-xs dark:text-gray-400"},"Действие")])])],-1)),e("tbody",null,[(y(!0),_(W,null,le(b(i),j=>(y(),Q(Hr,{key:j.id,attribute:j,onEdit:P,onDelete:I},null,8,["attribute"]))),128))])])]),C(ke,{"current-page":b(p),"total-pages":b(m),onPageChange:se},null,8,["current-page","total-pages"])]),C(aa,{"is-visible":b(f),"is-editing":b(w),attribute:b(d),errors:q.value,onClose:b($),onSave:O},null,8,["is-visible","is-editing","attribute","errors","onClose"]),C(me,{alerts:b(B)},null,8,["alerts"]),C(be,{isVisible:G.value,productName:(A=N.value)==null?void 0:A.name,productArticle:(M=N.value)==null?void 0:M.type,onClose:x[2]||(x[2]=j=>G.value=!1),onConfirm:J},null,8,["isVisible","productName","productArticle"])],64)}}};function ca(){const t=v(!1),r=v(!1),a=v(null);return{showModal:t,isEditing:r,currentCategory:a,openCreateModal:()=>{r.value=!1,a.value=null,t.value=!0},openEditModal:o=>{r.value=!0,a.value=o,t.value=!0},closeModal:()=>{t.value=!1,r.value=!1,a.value=null}}}function ga(t={}){const r=v({name:"",description:"",order:null,parent_id:null,is_plumbing:!1,...t});return{form:r,resetForm:()=>{r.value={name:"",description:"",order:null,parent_id:null,is_plumbing:!1}},setForm:l=>{r.value={...r.value,...l}}}}function pa(){const t=v([]);return{alerts:t,showAlert:(g,l,i)=>{const o={show:!0,type:g,title:l,message:i};t.value.push(o),setTimeout(()=>{const p=t.value.indexOf(o);p>-1&&t.value.splice(p,1)},3e3)},clearAlerts:()=>{t.value=[]}}}function ma(t){const r=ye({}),a=()=>{!t.value||!t.value.name||typeof t.value.name!="string"||!t.value.name.trim()?r.name="Название категории обязательно.":t.value.name.length>255?r.name="Название категории не должно превышать 255 символов.":r.name=""},g=()=>{t.value&&t.value.description&&t.value.description.length>1e3?r.description="Описание не должно превышать 1000 символов.":r.description=""},l=()=>{t.value&&t.value.order!==null&&(isNaN(t.value.order)||t.value.order<0)?r.order="Порядок должен быть положительным числом.":r.order=""},i=()=>{t.value&&t.value.parent_id!==null&&(isNaN(t.value.parent_id)||t.value.parent_id<=0)?r.parent_id="Неверный ID родительской категории.":r.parent_id=""},o=()=>{a(),g(),l(),i()},p=()=>Object.values(r).some(u=>u);let m=!1;return S(()=>{var u;return(u=t.value)==null?void 0:u.name},(u,c)=>{if(!m){m=!0;return}u!==c&&c!==void 0&&a()}),S(()=>{var u;return(u=t.value)==null?void 0:u.description},(u,c)=>{m&&u!==c&&c!==void 0&&g()}),S(()=>{var u;return(u=t.value)==null?void 0:u.order},(u,c)=>{m&&u!==c&&c!==void 0&&l()}),S(()=>{var u;return(u=t.value)==null?void 0:u.parent_id},(u,c)=>{m&&u!==c&&c!==void 0&&i()}),{errors:r,validateAll:o,hasErrors:p,resetErrors:()=>{Object.keys(r).forEach(u=>{r[u]=""})}}}const fa={class:"border-t border-gray-100 dark:border-gray-800"},va={class:"py-3 whitespace-nowrap"},ha={class:"flex items-center gap-3"},ya={class:"font-medium text-gray-800 text-theme-sm dark:text-white/90"},ba={class:"py-3 whitespace-nowrap"},xa={key:0,class:"flex items-center justify-center w-6 h-6 bg-success-50 dark:bg-success-500/15 rounded-full"},wa={key:1,class:"flex items-center justify-center w-6 h-6 bg-error-50 dark:bg-error-500/15 rounded-full"},ka={class:"py-3 whitespace-nowrap"},$a={class:"text-gray-500 text-theme-sm dark:text-gray-400"},_a={class:"py-3 whitespace-nowrap text-center"},Ca=["aria-label"],Ea=["aria-label"],ja={__name:"CategoryRow",props:{category:{type:Object,required:!0}},emits:["edit","delete"],setup(t,{emit:r}){const a=r,g=i=>{a("edit",i)},l=i=>{a("delete",i)};return(i,o)=>(y(),_("tr",fa,[e("td",va,[e("div",ha,[e("div",null,[e("p",ya,T(t.category.name),1)])])]),e("td",ba,[t.category.description?(y(),_("div",xa,[C(b(Ve),{class:"w-4 h-4 text-success-600 dark:text-success-500"})])):(y(),_("div",wa,[C(b(Se),{class:"w-4 h-4 text-error-600 dark:text-error-500"})]))]),e("td",ka,[e("p",$a,T(t.category.order||"Не указан"),1)]),e("td",_a,[e("button",{class:"inline-flex items-center justify-center gap-2 rounded-lg transition shadow-theme-xs bg-white text-gray-700 ring-1 ring-gray-300 hover:bg-success-50 hover:ring-success-300 hover:text-success-700 dark:bg-gray-800 dark:text-gray-400 dark:ring-gray-700 dark:hover:bg-success-500/15 dark:hover:ring-success-500/50 dark:hover:text-success-500 cursor-pointer p-1 mr-3",onClick:o[0]||(o[0]=p=>g(t.category)),"aria-label":`Редактировать категорию ${t.category.name}`},[C(b(_e))],8,Ca),e("button",{class:"inline-flex items-center justify-center gap-2 rounded-lg transition shadow-theme-xs bg-white text-gray-700 ring-1 ring-gray-300 hover:bg-error-50 hover:ring-error-300 hover:text-error-700 dark:bg-gray-800 dark:text-gray-400 dark:ring-gray-700 dark:hover:bg-error-500/15 dark:hover:ring-error-500/50 dark:hover:text-error-500 cursor-pointer p-1",onClick:o[1]||(o[1]=p=>l(t.category.id)),"aria-label":`Удалить категорию ${t.category.name}`},[C(b($e))],8,Ea)])]))}},Aa={class:"relative bg-white dark:bg-gray-800 rounded-xl shadow-lg max-w-md w-full mx-4"},Ma={class:"p-6"},Ta={class:"text-lg font-semibold text-gray-900 dark:text-white text-center mb-4"},Pa={key:0,class:"mt-1.5 text-theme-xs text-error-500"},Va={key:0,class:"mt-1.5 text-theme-xs text-error-500"},Sa={key:0,class:"mt-1.5 text-theme-xs text-error-500"},Ba={class:"flex items-center"},Oa={class:"flex justify-end gap-3 pt-4"},La={__name:"CategoryModal",props:{isVisible:{type:Boolean,default:!1},isEditing:{type:Boolean,default:!1},category:{type:Object,default:()=>({name:"",description:"",order:null,parent_id:null,is_plumbing:!1})},errors:{type:Object,default:()=>({})}},emits:["close","save"],setup(t,{emit:r}){const a=t,g=r;pe("categoriesData");const l=v({name:"",description:"",order:null,parent_id:null,is_plumbing:!1}),i=v([]),o=async()=>{try{const c=await fetch("http://test.dennistp.beget.tech/api/categories?per_page=1000");if(c.ok){const s=await c.json();i.value=s.data||[]}}catch(c){console.error("Error fetching all categories:",c)}},p=ce(()=>i.value.find(c=>c.slug==="santexnika")),m=c=>c?"dark:bg-dark-900 shadow-theme-xs focus:border-error-300 focus:ring-error-500/10 dark:focus:border-error-800 h-11 w-full rounded-lg border border-error-300 bg-transparent px-4 py-2.5 text-sm text-gray-800 placeholder:text-gray-400 focus:ring-3 focus:outline-hidden dark:border-error-700 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30 appearance-none":"dark:bg-dark-900 shadow-theme-xs focus:border-brand-300 focus:ring-brand-500/10 dark:focus:border-brand-800 h-11 w-full rounded-lg border border-gray-300 bg-transparent px-4 py-2.5 text-sm text-gray-800 placeholder:text-gray-400 focus:ring-3 focus:outline-hidden dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30 appearance-none";S(()=>a.isVisible,async c=>{var s;c?(i.value.length===0&&await o(),a.isEditing&&a.category?l.value={...a.category,is_plumbing:a.category.parent_id===((s=p.value)==null?void 0:s.id)}:l.value={name:"",description:"",order:null,parent_id:null,is_plumbing:!1}):l.value={name:"",description:"",order:null,parent_id:null,is_plumbing:!1}}),S(()=>l.value.is_plumbing,c=>{var s;l.value.parent_id=c?(s=p.value)==null?void 0:s.id:null});const k=()=>{g("close")},u=()=>{g("save",{...l.value,is_plumbing:l.value.is_plumbing?"1":"0"})};return(c,s)=>t.isVisible?(y(),Q(we,{key:0,onClose:k},{body:Z(()=>[e("div",Aa,[e("div",Ma,[e("h3",Ta,T(t.isEditing?"Редактировать категорию":"Создать категорию"),1),e("form",{onSubmit:ge(u,["prevent"]),class:"space-y-4"},[e("div",null,[s[4]||(s[4]=e("label",{for:"nameCategory",class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Название ",-1)),F(e("input",{type:"text",id:"nameCategory","onUpdate:modelValue":s[0]||(s[0]=f=>l.value.name=f),required:"",class:D(m(t.errors.name))},null,2),[[X,l.value.name]]),t.errors.name?(y(),_("p",Pa,T(t.errors.name),1)):H("",!0)]),e("div",null,[s[5]||(s[5]=e("label",{for:"description",class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Описание ",-1)),F(e("textarea",{id:"description","onUpdate:modelValue":s[1]||(s[1]=f=>l.value.description=f),rows:"3",class:D(m(t.errors.description))},null,2),[[X,l.value.description]]),t.errors.description?(y(),_("p",Va,T(t.errors.description),1)):H("",!0)]),e("div",null,[s[6]||(s[6]=e("label",{for:"order",class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Порядок ",-1)),F(e("input",{type:"number",id:"order","onUpdate:modelValue":s[2]||(s[2]=f=>l.value.order=f),min:"0",class:D(m(t.errors.order))},null,2),[[X,l.value.order,void 0,{number:!0}]]),t.errors.order?(y(),_("p",Sa,T(t.errors.order),1)):H("",!0)]),e("div",Ba,[C(Be,{id:"is_active",label:"Относится к сантехнике",checked:l.value.is_plumbing,"onUpdate:checked":s[3]||(s[3]=f=>l.value.is_plumbing=f)},null,8,["checked"])]),e("div",Oa,[C(re,{variant:"outline",onClick:k},{default:Z(()=>s[7]||(s[7]=[z("Отмена")])),_:1}),C(re,{variant:"primary",type:"submit"},{default:Z(()=>[z(T(t.isEditing?"Сохранить":"Создать"),1)]),_:1})])],32)])])]),_:1})):H("",!0)}},Ua={class:"overflow-hidden rounded-2xl border border-gray-200 bg-white px-4 pb-3 pt-4 dark:border-gray-800 dark:bg-white/[0.03] sm:px-6"},Ha={class:"flex flex-col md:gap-1 gap-3 mb-4 sm:flex-row sm:items-center sm:justify-end"},Ia={class:"max-w-full overflow-x-auto custom-scrollbar"},Da={class:"min-w-full"},Na={__name:"CategoriesTable",emits:["update:searchQuery"],setup(t,{emit:r}){const a=xe,g=pe("categoriesData"),{categories:l,searchQuery:i,currentPage:o,totalPages:p,fetchCategories:m,createCategory:k,updateCategory:u,deleteCategory:c}=g,{showModal:s,isEditing:f,currentCategory:w,openCreateModal:d,openEditModal:n,closeModal:h}=ca(),$=O=>{te.value={},n(O)};ga();const{alerts:P,showAlert:U}=pa(),{errors:B,hasErrors:V,resetErrors:ae}=ma({name:"",description:"",order:null,parent_id:null}),te=v({}),K=v(!1),q=v(null),G=O=>{O>=1&&O<=p.value&&m(O)},N=O=>{q.value=O,K.value=!0},Y=async O=>{var I,J;try{if(Object.assign(B,{name:"",description:"",order:"",parent_id:""}),(!O.name||!O.name.trim())&&(B.name="Название категории обязательно."),V()){console.log("Validation errors:",B);return}let E;if(f.value?E=await u(w.value.id,O):E=await k(O),E.success)U("success","Успешно",f.value?"Категория успешно обновлена":"Категория успешно создана"),await m(),h(),ae();else{const x={};if(E.errors)for(const[M,j]of Object.entries(E.errors))Array.isArray(j)?x[M]=j[0]:x[M]=j;te.value=x;const A=Object.values(x);A.length>0?A.forEach(M=>{U("error","Ошибка валидации",M)}):U("error","Ошибка валидации",E.message||"Ошибка валидации")}}catch(E){console.error("Error saving category:",E);const x=((J=(I=E.response)==null?void 0:I.data)==null?void 0:J.message)||"Не удалось сохранить категорию";U("error","Ошибка",x)}},se=async O=>{const I=l.value.find(J=>J.id===O);I&&N(I)},oe=async()=>{K.value=!1;try{await c(q.value.id),await m(),U("success","Успешно","Категория успешно удалена")}catch(O){console.error("Error deleting category:",O),U("error","Ошибка","Не удалось удалить категорию")}};return(O,I)=>{var J,E;return y(),_(W,null,[e("div",Ua,[e("div",Ha,[e("button",{type:"button",class:"bg-brand-500 shadow-theme-xs hover:bg-brand-600 inline-flex items-center justify-center gap-1 rounded-lg px-3 py-3 text-sm font-medium text-white transition",onClick:I[0]||(I[0]=(...x)=>b(d)&&b(d)(...x)),"aria-label":"Добавить новую категорию"},[(y(),Q(ne(b(a)),{width:"20",height:"20"})),I[2]||(I[2]=z(" Добавить категорию "))])]),e("div",Ia,[e("table",Da,[I[3]||(I[3]=e("thead",null,[e("tr",{class:"border-t border-gray-100 dark:border-gray-800"},[e("th",{class:"py-3 text-left"},[e("p",{class:"font-bold text-gray-500 text-theme-xs dark:text-gray-400"},"Название")]),e("th",{class:"py-3 text-left"},[e("p",{class:"font-bold text-gray-500 text-theme-xs dark:text-gray-400"},"Описание")]),e("th",{class:"py-3 text-left"},[e("p",{class:"font-bold text-gray-500 text-theme-xs dark:text-gray-400"},"Порядок")]),e("th",{class:"py-3 text-center"},[e("p",{class:"font-bold text-gray-500 text-theme-xs dark:text-gray-400"},"Действие")])])],-1)),e("tbody",null,[(y(!0),_(W,null,le(b(l),x=>(y(),Q(ja,{key:x.id,category:x,onEdit:$,onDelete:se},null,8,["category"]))),128))])])]),C(ke,{"current-page":b(o),"total-pages":b(p),onPageChange:G},null,8,["current-page","total-pages"])]),C(La,{"is-visible":b(s),"is-editing":b(f),category:b(w),errors:te.value,onClose:b(h),onSave:Y},null,8,["is-visible","is-editing","category","errors","onClose"]),C(me,{alerts:b(P)},null,8,["alerts"]),C(be,{isVisible:K.value,productName:(J=q.value)==null?void 0:J.name,productArticle:(E=q.value)==null?void 0:E.slug,onClose:I[1]||(I[1]=x=>K.value=!1),onConfirm:oe},null,8,["isVisible","productName","productArticle"])],64)}}},ie="http://test.dennistp.beget.tech";function Ra(){const t=v([]),r=v(!1),a=v(null),g=v(""),l=v(1),i=v(5),o=v(1),p=v(0),m=async(d=1)=>{r.value=!0,a.value=null;const n=new URLSearchParams;g.value.trim()&&n.append("search",g.value.trim()),n.append("page",d.toString()),n.append("per_page",i.value.toString());const h=`${ie}/api/colors${n.toString()?"?"+n.toString():""}`;try{const $=await fetch(h);if(!$.ok)throw new Error(`HTTP error! status: ${$.status}`);const P=await $.json();t.value=P.data||[],o.value=P.last_page||1,p.value=P.total||0,l.value=P.current_page||1}catch($){a.value=$.message,console.error("Error fetching colors:",$)}finally{r.value=!1}},k=async()=>{r.value=!0,a.value=null;const d=new URLSearchParams;g.value.trim()&&d.append("search",g.value.trim()),d.append("per_page","all");const n=`${ie}/api/colors${d.toString()?"?"+d.toString():""}`;try{const h=await fetch(n);if(!h.ok)throw new Error(`HTTP error! status: ${h.status}`);const $=await h.json();t.value=$.data||[],o.value=1,p.value=t.value.length,l.value=1}catch(h){a.value=h.message,console.error("Error fetching all colors:",h)}finally{r.value=!1}},u=async d=>{r.value=!0,a.value=null;try{const n=await fetch(`${ie}/api/colors`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(d)}),h=await n.json();if(!n.ok){if(n.status===422)return{success:!1,errors:h.errors,message:h.message};throw new Error(`HTTP error! status: ${n.status}`)}return await m(l.value),{success:!0,data:h}}catch(n){throw a.value=n.message,console.error("Error creating color:",n),n}finally{r.value=!1}},c=async(d,n)=>{r.value=!0,a.value=null;try{const h=await fetch(`${ie}/api/colors/${d}`,{method:"PUT",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(n)}),$=await h.json();if(!h.ok){if(h.status===422)return{success:!1,errors:$.errors,message:$.message};throw new Error(`HTTP error! status: ${h.status}`)}return await m(l.value),{success:!0,data:$}}catch(h){throw a.value=h.message,console.error("Error updating color:",h),h}finally{r.value=!1}},s=async d=>{r.value=!0,a.value=null;try{const n=await fetch(`${ie}/api/colors/${d}`,{method:"DELETE"});if(!n.ok)throw new Error(`HTTP error! status: ${n.status}`);await m(l.value)}catch(n){throw a.value=n.message,console.error("Error deleting color:",n),n}finally{r.value=!1}},f=async d=>{r.value=!0,a.value=null;try{const n=await fetch(`${ie}/api/colors/${d}`);if(!n.ok)throw new Error(`HTTP error! status: ${n.status}`);const h=await n.json();return h.color||h}catch(n){throw a.value=n.message,console.error("Error fetching color:",n),n}finally{r.value=!1}};let w=null;return S(g,d=>{w&&clearTimeout(w),w=setTimeout(()=>{m()},500)}),{colors:t,loading:r,error:a,searchQuery:g,currentPage:l,perPage:i,totalPages:o,totalItems:p,fetchColors:m,fetchAllColors:k,createColor:u,updateColor:c,deleteColor:s,getColorById:f}}const de="http://test.dennistp.beget.tech";function Fa(){const t=v([]),r=v(!1),a=v(null),g=v(""),l=v(1),i=v(5),o=v(1),p=v(0),m=async(d=1)=>{r.value=!0,a.value=null;const n=new URLSearchParams;g.value.trim()&&n.append("search",g.value.trim()),n.append("page",d.toString()),n.append("per_page",i.value.toString());const h=`${de}/api/brands${n.toString()?"?"+n.toString():""}`;try{const $=await fetch(h);if(!$.ok)throw new Error(`HTTP error! status: ${$.status}`);const P=await $.json();t.value=P.data||[],o.value=P.last_page||1,p.value=P.total||0,l.value=P.current_page||1}catch($){a.value=$.message,console.error("Error fetching brands:",$)}finally{r.value=!1}},k=async()=>{r.value=!0,a.value=null;const d=new URLSearchParams;g.value.trim()&&d.append("search",g.value.trim()),d.append("per_page","all");const n=`${de}/api/brands${d.toString()?"?"+d.toString():""}`;try{const h=await fetch(n);if(!h.ok)throw new Error(`HTTP error! status: ${h.status}`);const $=await h.json();t.value=$.data||[],o.value=1,p.value=t.value.length,l.value=1}catch(h){a.value=h.message,console.error("Error fetching all brands:",h)}finally{r.value=!1}},u=async(d,n)=>{r.value=!0,a.value=null;try{const h=new FormData;Object.keys(d).forEach(U=>{const B=d[U];typeof B=="boolean"?h.append(U,B?"1":"0"):h.append(U,(B==null?void 0:B.toString())||"")}),n&&h.append("image",n);const $=await fetch(`${de}/api/brands`,{method:"POST",headers:{Accept:"application/json"},body:h}),P=await $.json();if(!$.ok){if($.status===422)return{success:!1,errors:P.errors,message:P.message};throw new Error(`HTTP error! status: ${$.status}`)}return await m(l.value),{success:!0,data:P}}catch(h){throw a.value=h.message,console.error("Error creating brand:",h),h}finally{r.value=!1}},c=async(d,n,h)=>{r.value=!0,a.value=null;try{const $=new FormData;Object.keys(n).forEach(B=>{if(B==="image"&&!h)return;const V=n[B];typeof V=="boolean"?$.append(B,V?"1":"0"):$.append(B,(V==null?void 0:V.toString())||"")}),h&&$.append("image",h),$.append("_method","PUT");const P=await fetch(`${de}/api/brands/${d}`,{method:"POST",headers:{Accept:"application/json"},body:$}),U=await P.json();if(!P.ok){if(P.status===422)return{success:!1,errors:U.errors,message:U.message};throw new Error(`HTTP error! status: ${P.status}`)}return await m(l.value),{success:!0,data:U}}catch($){throw a.value=$.message,console.error("Error updating brand:",$),$}finally{r.value=!1}},s=async d=>{r.value=!0,a.value=null;try{const n=await fetch(`${de}/api/brands/${d}`,{method:"DELETE"});if(!n.ok)throw new Error(`HTTP error! status: ${n.status}`);await m(l.value)}catch(n){throw a.value=n.message,console.error("Error deleting brand:",n),n}finally{r.value=!1}},f=async d=>{r.value=!0,a.value=null;try{const n=await fetch(`${de}/api/brands/${d}`);if(!n.ok)throw new Error(`HTTP error! status: ${n.status}`);const h=await n.json();return h.brand||h}catch(n){throw a.value=n.message,console.error("Error fetching brand:",n),n}finally{r.value=!1}};let w=null;return S(g,d=>{w&&clearTimeout(w),w=setTimeout(()=>{m()},500)}),{brands:t,loading:r,error:a,searchQuery:g,currentPage:l,perPage:i,totalPages:o,totalItems:p,fetchBrands:m,fetchAllBrands:k,createBrand:u,updateBrand:c,deleteBrand:s,getBrandById:f}}const ue="http://test.dennistp.beget.tech";function za(){const t=v([]),r=v(!1),a=v(null),g=v(""),l=v(1),i=v(5),o=v(1),p=v(0),m=async(w=1)=>{r.value=!0,a.value=null;const d=new URLSearchParams;g.value.trim()&&d.append("search",g.value.trim()),d.append("page",w.toString()),d.append("per_page",i.value.toString());const n=`${ue}/api/attributes${d.toString()?"?"+d.toString():""}`;try{const h=await fetch(n);if(!h.ok)throw new Error(`HTTP error! status: ${h.status}`);const $=await h.json();t.value=$.data||[],o.value=$.last_page||1,p.value=$.total||0,l.value=$.current_page||1}catch(h){a.value=h.message,console.error("Error fetching attributes:",h)}finally{r.value=!1}},k=async w=>{r.value=!0,a.value=null;try{const d=await fetch(`${ue}/api/attributes`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(w)}),n=await d.json();if(!d.ok){if(d.status===422)return{success:!1,errors:n.errors,message:n.message};throw new Error(`HTTP error! status: ${d.status}`)}return await m(l.value),{success:!0,data:n}}catch(d){throw a.value=d.message,console.error("Error creating attribute:",d),d}finally{r.value=!1}},u=async(w,d)=>{r.value=!0,a.value=null;try{const n=await fetch(`${ue}/api/attributes/${w}`,{method:"PUT",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(d)}),h=await n.json();if(!n.ok){if(n.status===422)return{success:!1,errors:h.errors,message:h.message};throw new Error(`HTTP error! status: ${n.status}`)}return await m(l.value),{success:!0,data:h}}catch(n){throw a.value=n.message,console.error("Error updating attribute:",n),n}finally{r.value=!1}},c=async w=>{r.value=!0,a.value=null;try{const d=await fetch(`${ue}/api/attributes/${w}`,{method:"DELETE"});if(!d.ok)throw new Error(`HTTP error! status: ${d.status}`);await m(l.value)}catch(d){throw a.value=d.message,console.error("Error deleting attribute:",d),d}finally{r.value=!1}},s=async w=>{r.value=!0,a.value=null;try{const d=await fetch(`${ue}/api/attributes/${w}`);if(!d.ok)throw new Error(`HTTP error! status: ${d.status}`);const n=await d.json();return n.attribute||n}catch(d){throw a.value=d.message,console.error("Error fetching attribute:",d),d}finally{r.value=!1}};let f=null;return S(g,w=>{f&&clearTimeout(f),f=setTimeout(()=>{m()},500)}),{attributes:t,loading:r,error:a,searchQuery:g,currentPage:l,perPage:i,totalPages:o,totalItems:p,fetchAttributes:m,createAttribute:k,updateAttribute:u,deleteAttribute:c,getAttributeById:s}}const he="http://test.dennistp.beget.tech";function Qa(){const t=v([]),r=v(!1),a=v(null),g=v(""),l=v(1),i=v(5),o=v(1),p=v(0),m=async(f=1)=>{r.value=!0,a.value=null;const w=new URLSearchParams;g.value.trim()&&w.append("search",g.value.trim()),w.append("page",f.toString()),w.append("per_page",i.value.toString());const d=`${he}/api/categories${w.toString()?"?"+w.toString():""}`;try{const n=await fetch(d);if(!n.ok)throw new Error(`HTTP error! status: ${n.status}`);const h=await n.json();t.value=h.data||[],o.value=h.last_page||1,p.value=h.total||0,l.value=h.current_page||1}catch(n){a.value=n.message,console.error("Error fetching categories:",n)}finally{r.value=!1}},k=async f=>{r.value=!0,a.value=null;try{const w=await fetch(`${he}/api/categories`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(f)}),d=await w.json();if(!w.ok){if(w.status===422)return{success:!1,errors:d.errors,message:d.message};throw new Error(`HTTP error! status: ${w.status}`)}return await m(l.value),{success:!0,data:d}}catch(w){throw a.value=w.message,console.error("Error creating category:",w),w}finally{r.value=!1}},u=async(f,w)=>{r.value=!0,a.value=null;try{const d=await fetch(`${he}/api/categories/${f}`,{method:"PUT",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(w)}),n=await d.json();if(!d.ok){if(d.status===422)return{success:!1,errors:n.errors,message:n.message};throw new Error(`HTTP error! status: ${d.status}`)}return await m(l.value),{success:!0,data:n}}catch(d){throw a.value=d.message,console.error("Error updating category:",d),d}finally{r.value=!1}},c=async f=>{r.value=!0,a.value=null;try{const w=await fetch(`${he}/api/categories/${f}`,{method:"DELETE"});if(!w.ok)throw new Error(`HTTP error! status: ${w.status}`);await m(l.value)}catch(w){throw a.value=w.message,console.error("Error deleting category:",w),w}finally{r.value=!1}};let s=null;return S(g,f=>{s&&clearTimeout(s),s=setTimeout(()=>{m()},500)}),{categories:t,loading:r,error:a,searchQuery:g,currentPage:l,perPage:i,totalPages:o,totalItems:p,fetchCategories:m,createCategory:k,updateCategory:u,deleteCategory:c}}const Ga={key:0,class:"flex justify-center items-center h-screen"},qa={key:1,class:"flex flex-col justify-center items-center h-screen font-bold text-error-700 text-theme-xl dark:text-error-500"},Ja={key:2,class:"flex flex-col justify-center items-center h-screen menu-item-icon-active text-center font-bold text-theme-xl m-5"},Za={key:3},Xa={class:"grid grid-cols-12 gap-4 md:gap-6 mb-4 md:mb-6"},Wa={class:"col-span-12 xl:col-span-6"},Ka={class:"col-span-12 xl:col-span-6"},Ya={class:"col-span-12 xl:col-span-8"},es={class:"col-span-12 xl:col-span-4"},us={__name:"Characteristics",setup(t){const r=v("Характеричтики"),a=v(!0),g=v(null),l=v({}),i=Ra(),o=Fa(),p=za(),m=Qa();ve("colorsData",i),ve("brandsData",o),ve("attributesData",p),ve("categoriesData",m);const k=async()=>{a.value=!0,g.value=null;try{await Promise.all([i.fetchColors(),o.fetchBrands(),p.fetchAttributes(),m.fetchCategories()]),l.value={id:1}}catch(u){g.value=u.message||"Ошибка при загрузке данных"}finally{a.value=!1}};return Me(()=>{k()}),(u,c)=>(y(),Q(Oe,null,{default:Z(()=>[C(Le,{pageTitle:r.value},null,8,["pageTitle"]),a.value?(y(),_("div",Ga,c[0]||(c[0]=[e("div",{class:"animate-spin rounded-full h-16 w-16 border-b-2 border-brand-500"},null,-1)]))):g.value?(y(),_("div",qa,[c[1]||(c[1]=z(" Ошибка при загрузке")),c[2]||(c[2]=e("br",null,null,-1)),e("button",{class:"inline-flex items-center justify-center font-medium gap-2 rounded-lg transition px-4 py-3 text-sm bg-brand-500 text-white shadow-theme-xs hover:bg-brand-600 disabled:bg-brand-300 mt-2",onClick:k}," Попробовать снова ")])):l.value.id?(y(),_("div",Za,[e("div",Xa,[e("div",Wa,[C(At)]),e("div",Ka,[C(wr)]),e("div",Ya,[C(ua)]),e("div",es,[C(Na)])])])):(y(),_("div",Ja," Характеристики не найден "))]),_:1}))}};export{us as default};
