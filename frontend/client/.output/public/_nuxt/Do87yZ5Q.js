import{_ as z,a as E,b as R,c as j}from"./DNCqsGop.js";import{_ as D}from"./D7avEDMr.js";import{_ as V}from"./Bqof-9AT.js";import{_ as q,E as L,P as J,z as M,o as T,s as G,w as b,d as u,A as H,e as n,f as i,j as o,g as m,u as t,x as f,m as h,t as k,y as w,F as K,k as Q,i as W,C as X}from"#entry";import{u as Y}from"./Duy6kUCN.js";const Z={class:"shop-category-area pt-100px pb-100px"},ee={class:"container"},te={class:"row"},se={class:"col-lg-9 order-lg-last col-md-12 order-md-first"},oe={class:"shop-top-bar d-flex justify-content-between mb-3 row"},ae={class:"category-text col-sm-12 col-md-6 mb-3 mb-md-0"},re={key:0,class:"h3 m-0"},ie={key:1},ne={key:1,class:"error text-center mt-5"},ce={key:2,class:"text-center mt-2"},le={key:3,class:"shop-bottom-area"},pe={class:"row"},ue={class:"col"},me={class:"tab-content"},_e={class:"tab-pane fade show active",id:"shop-grid"},de={class:"row mb-n-30px"},ge={__name:"[slug]",setup(fe){const p=L().params.slug,e=J(),_=M();T(async()=>{e.resetFilters();try{await _.fetchSiteInfo()}catch(s){console.error("Failed to load site info:",s)}});const d=G(),c=d.public.siteUrl||"https://agatceramic.ru",{data:g,pending:y,error:C,execute:F}=Y(`category-products-${p}`,()=>$fetch(`${d.public.apiBase}/api/client/category/${p}/products`,{query:e.queryParams}),{immediate:!1}),$=()=>F();b(()=>e.queryParams,()=>$(),{immediate:!0});const a=u(()=>g.value?.category||null),r=u(()=>g.value?.products||null);b(g,s=>{s&&s.filters&&e.setFilters(s.filters)},{immediate:!0});const P=u(()=>C.value&&!y.value),v=u(()=>r.value?.data?{"@context":"https://schema.org","@type":"ItemList",name:a.value?.name||"Категория товаров",description:a.value?.description||"",url:`${d.public.siteUrl}/category/${p}`,numberOfItems:r.value.data.length,itemListElement:r.value.data.map((s,l)=>({"@type":"Product",position:l+1,name:s.name,description:s.description,image:s.image,offers:{"@type":"Offer",price:s.price,priceCurrency:"RUB",availability:s.in_stock?"https://schema.org/InStock":"https://schema.org/OutOfStock"}}))}:null);return H(u(()=>({title:a.value?.name?`${a.value.name} - AgatCeramic. Купить в Москве по низкой цене с доставкой`:"Категория товаров - AgatCeramic",meta:[{name:"description",content:a.value?.description||"Купить товары категории в интернет-магазине AgatCeramic"},{name:"keywords",content:a.value?.name?`${a.value.name}, керамическая плитка, сантехника`:"керамическая плитка, сантехника"},{property:"og:image",content:`${c}/images/stock/logo.png`},{property:"og:title",content:"AgatCeramic - Интернет-магазин плитки, керамогранита и сантехники"},{property:"og:description",content:a.value?.description||"Купить товары категории в интернет-магазине AgatCeramic"},{property:"og:url",content:`${c}/category/${p}`},{name:"twitter:image",content:`${c}/images/stock/logo.png`}],link:[{rel:"canonical",href:`${c}/category/${p}`}],script:[...v.value?[{type:"application/ld+json",children:JSON.stringify(v.value)}]:[],{type:"application/ld+json",children:JSON.stringify({"@context":"https://schema.org","@type":"Organization",name:"AgatCeramic",url:c,logo:`${c}/images/stock/logo.png`,description:"Интернет-магазин плитки, керамогранита и сантехники",email:_.getEmail,contactPoint:{"@type":"ContactPoint",telephone:_.getFormattedPhone,contactType:"customer service"}})}]}))),(s,l)=>{const A=z,S=E,O=D,U=V,I=R,B=j,N=X;return i(),n("main",Z,[o("div",ee,[m(A,{selectedFilters:t(e).selectedFilters,onRemoveFilter:t(e).removeFilter},null,8,["selectedFilters","onRemoveFilter"]),o("div",te,[o("div",se,[o("div",oe,[o("div",ae,[a.value?(i(),n("h1",re,k(a.value.name),1)):h("",!0),a.value?(i(),n("p",ie,k(a.value.description),1)):h("",!0)]),m(S,{"onUpdate:sortOption":t(e).handleSortChange},null,8,["onUpdate:sortOption"])]),t(y)?(i(),f(O,{key:0,text:"Загрузка товаров..."})):P.value?(i(),n("div",ne,[...l[0]||(l[0]=[o("h2",null,[w(" Произошла ошибка при загрузке товаров."),o("br"),w("Попробуйте перезагрузить страницу. ")],-1)])])):!r.value||!r.value.data||r.value.data.length===0?(i(),n("div",ce,[...l[1]||(l[1]=[o("h2",null,"Список товаров пуст",-1)])])):(i(),n("div",le,[o("div",pe,[o("div",ue,[o("div",me,[o("div",_e,[o("div",de,[(i(!0),n(K,null,Q(r.value.data,x=>(i(),f(U,{key:x.id,product:x},null,8,["product"]))),128))])])])])]),r.value.last_page>1?(i(),f(I,{key:0,"current-page":r.value.current_page,"total-pages":r.value.last_page,onChangePage:t(e).changePage},null,8,["current-page","total-pages","onChangePage"])):h("",!0)]))]),m(N,null,{default:W(()=>[m(B,{store:t(e),categories:t(e).filters.categories,subcategories:t(e).filters.subcategories,patterns:t(e).filters.patterns,weights:t(e).filters.weights,colors:t(e).filters.colors,glues:t(e).filters.glues,mixture_types:t(e).filters.mixture_types,seams:t(e).filters.seams,textures:t(e).filters.textures,countries:t(e).filters.countries,sizes:t(e).filters.sizes,materials:t(e).filters.materials,waterproofs:t(e).filters.waterproofs,collections:t(e).filters.collections,volumes:t(e).filters.volumes,product_weights:t(e).filters.product_weights,installation_types:t(e).filters.installation_types,shapes:t(e).filters.shapes,applications:t(e).filters.applications,drying_times:t(e).filters.drying_times,package_weights:t(e).filters.package_weights,min_temps:t(e).filters.min_temps,max_temps:t(e).filters.max_temps,consumptions:t(e).filters.consumptions,brands:t(e).filters.brands,initialFilters:t(e).filters},null,8,["store","categories","subcategories","patterns","weights","colors","glues","mixture_types","seams","textures","countries","sizes","materials","waterproofs","collections","volumes","product_weights","installation_types","shapes","applications","drying_times","package_weights","min_temps","max_temps","consumptions","brands","initialFilters"])]),_:1})])])])}}},we=q(ge,[["__scopeId","data-v-f964407c"]]);export{we as default};
