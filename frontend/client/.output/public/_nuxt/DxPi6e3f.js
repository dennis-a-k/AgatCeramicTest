import{_ as R}from"./J-T6rV--.js";import{_ as $}from"./BHyTcNg2.js";import{_ as A,r as g,j as S,l as D,f as I,A as F,c as u,a as e,s as k,t as b,y as x,F as C,m as q,C as m,B as f,v as M,D as N,o as r}from"#entry";import{u as V}from"./BQEoau6r.js";import"./CNRvGLCQ.js";const j={class:"search-page"},z={class:"container"},E={class:"row"},H={class:"col-12"},L={class:"search-header"},O={key:0},T={class:"search-results"},U={key:1,class:"no-results"},W={key:2,class:"shop-bottom-area"},G={class:"row"},J={class:"col"},K={class:"tab-content"},Q={class:"tab-pane fade show active",id:"shop-grid"},X={class:"row mb-n-30px"},Y={key:0,class:"pagination-wrapper"},Z={"aria-label":"Page navigation"},ee={class:"pagination"},te=["onClick"],se={__name:"index",setup(ae){const p=F(),w=N(),B=M(),l=g(""),i=g([]),_=g(!1),s=g({total:0,current_page:1,per_page:24,last_page:1}),P=S(()=>{const t=s.value.current_page,a=s.value.last_page,d=2,v=[],o=[];for(let n=1;n<=a;n++)(n===1||n===a||n>=t-d&&n<=t+d)&&v.push(n);let c=0;for(let n of v)c&&(n-c===2?o.push(c+1):n-c!==1&&o.push("...")),o.push(n),c=n;return o}),y=async()=>{if(l.value){_.value=!0;try{const t=await $fetch(`${B.public.apiBase}/api/search`,{method:"POST",body:{query:l.value,page:s.value.current_page,per_page:s.value.per_page}});i.value=t.products.data||[],s.value={total:t.products.total||0,current_page:t.products.current_page||1,per_page:t.products.per_page||40,last_page:t.products.last_page||1}}catch(t){console.error("Ошибка при поиске товаров:",t),i.value=[]}finally{_.value=!1}}},h=t=>{t<1||t>s.value.last_page||t===s.value.current_page||(s.value.current_page=t,w.push({query:{...p.query,page:t}}))};return D(()=>p.query,t=>{l.value=t.q||"",s.value.current_page=parseInt(t.page)||1,l.value&&y()},{immediate:!0}),I(()=>{l.value=p.query.q||"",s.value.current_page=parseInt(p.query.page)||1,l.value&&y()}),V({title:"Результаты поиска - AgatCeramic",meta:[{name:"robots",content:"noindex, nofollow"}]}),(t,a)=>{const d=R,v=$;return r(),u("div",j,[e("div",z,[e("div",E,[e("div",H,[e("div",L,[a[2]||(a[2]=e("h1",null,"Результаты поиска",-1)),l.value?(r(),u("p",O,'По запросу: "'+b(l.value)+'"',1)):k("",!0)]),e("div",T,[_.value?(r(),x(d,{key:0,text:"Поиск товаров..."})):i.value.length===0&&!_.value?(r(),u("div",U,[...a[3]||(a[3]=[e("div",{class:"no-results-content"},[e("i",{class:"pe-7s-search"}),e("h3",null,"Ничего не найдено"),e("p",null,"Попробуйте изменить поисковый запрос")],-1)])])):(r(),u("div",W,[e("div",G,[e("div",J,[e("div",K,[e("div",Q,[e("div",X,[(r(!0),u(C,null,q(i.value,o=>(r(),x(v,{key:o.id,product:o},null,8,["product"]))),128))])])])])]),i.value.length>0&&s.value.last_page>1?(r(),u("div",Y,[e("nav",Z,[e("ul",ee,[e("li",{class:m(["page-item",{disabled:s.value.current_page===1}])},[e("a",{class:"page-link",href:"#",onClick:a[0]||(a[0]=f(o=>h(s.value.current_page-1),["prevent"]))},[...a[4]||(a[4]=[e("i",{class:"pe-7s-angle-left"},null,-1)])])],2),(r(!0),u(C,null,q(P.value,o=>(r(),u("li",{key:o,class:m(["page-item",{active:o===s.value.current_page}])},[e("a",{class:"page-link",href:"#",onClick:f(c=>h(o),["prevent"])},b(o),9,te)],2))),128)),e("li",{class:m(["page-item",{disabled:s.value.current_page===s.value.last_page}])},[e("a",{class:"page-link",href:"#",onClick:a[1]||(a[1]=f(o=>h(s.value.current_page+1),["prevent"]))},[...a[5]||(a[5]=[e("i",{class:"pe-7s-angle-right"},null,-1)])])],2)])])])):k("",!0)]))])])])])])}}},ce=A(se,[["__scopeId","data-v-831703be"]]);export{ce as default};
