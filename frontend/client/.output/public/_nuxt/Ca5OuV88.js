import{_ as N}from"./J-T6rV--.js";import{_ as q,z as A,J as L,r as f,f as D,j as k,y as U,o as i,w as d,a as t,c as u,u as y,b as v,e as O,d as r,D as T,K as c,L as m,F as $,m as I,t as a,A as M,v as P,M as R}from"#entry";import{u as E}from"./D8KdIBb5.js";const F={class:"checkout-area pt-100px pb-100px"},j={class:"container"},J={key:1},z={key:0,class:"col-md-12"},H={class:"empty-text-contant text-center"},K={class:"row"},G={class:"col-lg-6"},Q={class:"billing-info-wrap"},W={class:"row"},X={class:"col-lg-12"},Y={class:"billing-info mb-4"},Z={class:"col-lg-12"},tt={class:"billing-info mb-4"},et={class:"col-lg-6 col-md-6"},st={class:"billing-info mb-4"},ot={class:"col-lg-6 col-md-6"},lt={class:"billing-info mb-4"},nt={class:"additional-info-wrap"},it={class:"additional-info"},at={class:"col-lg-6 mt-md-30px mt-lm-30px"},rt={class:"your-order-area"},dt={class:"your-order-wrap gray-bg-4"},ut={class:"your-order-product-info"},ct={class:"your-order-middle"},mt={class:"col-7"},pt={class:"order-middle-left"},_t={class:"col-2 text-end"},vt={class:"col-3 text-end"},ft={class:"order-price"},yt={class:"your-order-total"},bt={class:"row Place-order mt-25"},gt={class:"col-md-6 mb-3 mb-md-0"},xt={class:"col-md-6"},ht=["disabled"],wt={class:"your-order-foot mt-3"},kt={class:"text-end"},Ut={__name:"index",setup(Ct){const n=A(),b=P(),{$toast:g}=L(),p=f(!1),x=f(!0);D(()=>{setTimeout(()=>{x.value=!1},500)});const o=f({name:"",email:"",phone:"",address:"",comment:""}),C=new Intl.NumberFormat("ru-RU",{style:"currency",currency:"RUB"}),h=l=>C.format(l),S=async()=>{p.value=!0;try{const l={customer:o.value,items:n.items,total:n.total},e=await $fetch(`${b.public.apiBase}/api/checkout`,{method:"POST",body:l});n.clearCart(),o.value={name:"",email:"",phone:"",address:"",comment:""},g.success("Заказ успешно оформлен! Мы свяжемся с вами в ближайшее время."),await R("/order/"+e.order)}catch(l){console.error("Error submitting order:",l),g.error("Произошла ошибка при оформлении заказа. Попробуйте еще раз.")}finally{p.value=!1}},w=k(()=>n.items.length===0?null:{"@context":"https://schema.org","@type":"ItemList",name:"Оформление заказа",itemListElement:n.items.map((l,e)=>({"@type":"Product",position:e+1,name:l.title,image:l.image,offers:{"@type":"Offer",price:l.price,priceCurrency:"RUB",availability:"https://schema.org/InStock"}}))});return E(k(()=>({title:"Оформление заказа - AgatCeramic",meta:[{name:"description",content:"Оформите заказ в интернет-магазине AgatCeramic"},{name:"keywords",content:"оформление заказа, заказ, AgatCeramic"},{name:"robots",content:"noindex, nofollow"}],link:[{rel:"canonical",href:`${b.public.siteUrl}/checkout`}],script:w.value?[{type:"application/ld+json",children:JSON.stringify(w.value)}]:[]}))),(l,e)=>{const V=N,_=O,B=M;return i(),U(B,null,{default:d(()=>[t("main",F,[t("div",j,[x.value?(i(),U(V,{key:0,text:"Загрузка страницы оформления..."})):(i(),u("div",J,[y(n).items.length===0?(i(),u("div",z,[t("div",H,[e[6]||(e[6]=t("i",{class:"pe-7s-cart"},null,-1)),e[7]||(e[7]=t("h3",null,"Ваша корзина пуста",-1)),v(_,{to:"/",class:"empty-cart-btn"},{default:d(()=>[...e[5]||(e[5]=[t("i",{class:"fa fa-arrow-left"},null,-1),r(" Перети к покупкам ",-1)])]),_:1})])])):(i(),u("form",{key:1,onSubmit:T(S,["prevent"])},[t("div",K,[t("div",G,[t("div",Q,[e[13]||(e[13]=t("h3",null,"Детали заказа",-1)),t("div",W,[t("div",X,[t("div",Y,[e[8]||(e[8]=t("label",{for:"name"},"ФИО",-1)),c(t("input",{type:"text",id:"name","onUpdate:modelValue":e[0]||(e[0]=s=>o.value.name=s),required:""},null,512),[[m,o.value.name]])])]),t("div",Z,[t("div",tt,[e[9]||(e[9]=t("label",{for:"address"},"Адрес доставки",-1)),c(t("input",{type:"text",id:"address","onUpdate:modelValue":e[1]||(e[1]=s=>o.value.address=s),required:""},null,512),[[m,o.value.address]])])]),t("div",et,[t("div",st,[e[10]||(e[10]=t("label",{for:"phone"},"Телефон",-1)),c(t("input",{type:"tel",id:"phone","onUpdate:modelValue":e[2]||(e[2]=s=>o.value.phone=s),required:""},null,512),[[m,o.value.phone]])])]),t("div",ot,[t("div",lt,[e[11]||(e[11]=t("label",{for:"email"},"Электронная почта",-1)),c(t("input",{type:"email",id:"email","onUpdate:modelValue":e[3]||(e[3]=s=>o.value.email=s),required:""},null,512),[[m,o.value.email]])])])]),t("div",nt,[t("div",it,[e[12]||(e[12]=t("label",{for:"comment"},"Комментарий к заказу",-1)),c(t("textarea",{id:"comment","onUpdate:modelValue":e[4]||(e[4]=s=>o.value.comment=s)},null,512),[[m,o.value.comment]])])])])]),t("div",at,[t("div",rt,[e[21]||(e[21]=t("h3",null,"Ваш заказ",-1)),t("div",dt,[t("div",ut,[e[15]||(e[15]=t("div",{class:"your-order-top"},[t("ul",null,[t("li",null,"Товар"),t("li",null,"Стоимость")])],-1)),t("div",ct,[(i(!0),u($,null,I(y(n).items,s=>(i(),u("div",{key:s.id,class:"row align-items-center lh-1 mb-3"},[t("div",mt,[t("span",pt,a(s.title)+a(s.weight_kg?`, ${s.weight_kg} кг`:""),1)]),t("div",_t," × "+a(s.quantity)+" "+a(s.unit==="шт"?"шт.":s.unit==="кв.м"?"м²":s.unit),1),t("div",vt,[t("span",ft,a(h(s.price*s.quantity)),1)])]))),128))]),t("div",yt,[t("ul",null,[e[14]||(e[14]=t("li",{class:"order-total"},"Итого",-1)),t("li",null,a(h(y(n).total)),1)])])])]),t("div",bt,[t("div",gt,[v(_,{to:"/cart",class:"btn-change"},{default:d(()=>[...e[16]||(e[16]=[r("Изменить",-1)])]),_:1})]),t("div",xt,[t("button",{type:"submit",class:"btn-order",style:{width:"100%"},disabled:p.value},a(p.value?"Оформление...":"Заказать"),9,ht)])]),t("div",wt,[t("p",kt,[e[19]||(e[19]=r(" Нажимая кнопку «Заказать», я даю ",-1)),v(_,{to:"/personal-data",target:"_blank"},{default:d(()=>[...e[17]||(e[17]=[r("согласие",-1)])]),_:1}),e[20]||(e[20]=r(" на обработку персональных данных, в соответствии с ",-1)),v(_,{to:"/policy",target:"_blank"},{default:d(()=>[...e[18]||(e[18]=[r(" Политикой",-1)])]),_:1})])])])])])],32))]))])])]),_:1})}}},Nt=q(Ut,[["__scopeId","data-v-4f8456bb"]]);export{Nt as default};
