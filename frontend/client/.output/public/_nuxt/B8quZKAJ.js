import{_ as $}from"./J-T6rV--.js";import{_ as I}from"./Cu8iJB0-.js";import{_ as P,r as g,j as A,l as S,f as z,y as D,c,a as e,s as k,t as x,z as C,F as b,m as q,A as f,x as m,B as E,C as F,o as r}from"#entry";import"./DjH6Tuk8.js";const M={class:"search-page"},N={class:"container"},U={class:"row"},V={class:"col-12"},j={class:"search-header"},G={key:0},L={class:"search-results"},T={key:1,class:"no-results"},W={key:2,class:"shop-bottom-area"},H={class:"row"},J={class:"col"},K={class:"tab-content"},O={class:"tab-pane fade show active",id:"shop-grid"},Q={class:"row mb-n-30px"},X={key:0,class:"pagination-wrapper"},Y={"aria-label":"Page navigation"},Z={class:"pagination"},ee=["onClick"],se={__name:"index",setup(te){const p=D(),w=F(),B=E(),l=g(""),i=g([]),_=g(!1),t=g({total:0,current_page:1,per_page:24,last_page:1}),R=A(()=>{const s=t.value.current_page,a=t.value.last_page,d=2,v=[],o=[];for(let n=1;n<=a;n++)(n===1||n===a||n>=s-d&&n<=s+d)&&v.push(n);let u=0;for(let n of v)u&&(n-u===2?o.push(u+1):n-u!==1&&o.push("...")),o.push(n),u=n;return o}),y=async()=>{if(l.value){_.value=!0;try{const s=await $fetch(`${B.public.apiBase}/api/products/search/${encodeURIComponent(l.value)}`,{method:"GET",query:{page:t.value.current_page,per_page:t.value.per_page}});i.value=s.products.data||[],t.value={total:s.products.total||0,current_page:s.products.current_page||1,per_page:s.products.per_page||40,last_page:s.products.last_page||1}}catch(s){console.error("Ошибка при поиске товаров:",s),i.value=[]}finally{_.value=!1}}},h=s=>{s<1||s>t.value.last_page||s===t.value.current_page||(t.value.current_page=s,w.push({query:{...p.query,page:s}}))};return S(()=>p.query,s=>{l.value=s.q||"",t.value.current_page=parseInt(s.page)||1,l.value&&y()},{immediate:!0}),z(()=>{l.value=p.query.q||"",t.value.current_page=parseInt(p.query.page)||1,l.value&&y()}),(s,a)=>{const d=$,v=I;return r(),c("div",M,[e("div",N,[e("div",U,[e("div",V,[e("div",j,[a[2]||(a[2]=e("h1",null,"Результаты поиска",-1)),l.value?(r(),c("p",G,'По запросу: "'+x(l.value)+'"',1)):k("",!0)]),e("div",L,[_.value?(r(),C(d,{key:0,text:"Поиск товаров..."})):i.value.length===0&&!_.value?(r(),c("div",T,[...a[3]||(a[3]=[e("div",{class:"no-results-content"},[e("i",{class:"pe-7s-search"}),e("h3",null,"Ничего не найдено"),e("p",null,"Попробуйте изменить поисковый запрос")],-1)])])):(r(),c("div",W,[e("div",H,[e("div",J,[e("div",K,[e("div",O,[e("div",Q,[(r(!0),c(b,null,q(i.value,o=>(r(),C(v,{key:o.id,product:o},null,8,["product"]))),128))])])])])]),i.value.length>0&&t.value.last_page>1?(r(),c("div",X,[e("nav",Y,[e("ul",Z,[e("li",{class:f(["page-item",{disabled:t.value.current_page===1}])},[e("a",{class:"page-link",href:"#",onClick:a[0]||(a[0]=m(o=>h(t.value.current_page-1),["prevent"]))},[...a[4]||(a[4]=[e("i",{class:"pe-7s-angle-left"},null,-1)])])],2),(r(!0),c(b,null,q(R.value,o=>(r(),c("li",{key:o,class:f(["page-item",{active:o===t.value.current_page}])},[e("a",{class:"page-link",href:"#",onClick:m(u=>h(o),["prevent"])},x(o),9,ee)],2))),128)),e("li",{class:f(["page-item",{disabled:t.value.current_page===t.value.last_page}])},[e("a",{class:"page-link",href:"#",onClick:a[1]||(a[1]=m(o=>h(t.value.current_page+1),["prevent"]))},[...a[5]||(a[5]=[e("i",{class:"pe-7s-angle-right"},null,-1)])])],2)])])])):k("",!0)]))])])])])])}}},le=P(se,[["__scopeId","data-v-cd91bcd4"]]);export{le as default};
