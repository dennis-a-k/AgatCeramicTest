import{_ as q,a as I,b as V,c as L}from"./DcmmscuW.js";import{_ as H}from"./D7avEDMr.js";import{_ as J}from"./CJhqaehe.js";import{C as M,r as y,d as v,_ as G,D as K,o as Q,s as W,w as z,z as X,e as h,f as p,j as c,g as P,u as s,x as E,m as S,t as U,y as T,F as Y,k as Z,i as ee,B as te}from"#entry";import{u as se}from"./Cfk4yxQX.js";const N={categories:{nameField:"name"},brands:{nameField:"name"},colors:{nameField:"name"},patterns:{nameField:"name"},weights:{nameField:"value"},subcategories:{nameField:"name"},glues:{nameField:"name"},mixture_types:{nameField:"name"},seams:{nameField:"name"},textures:{nameField:"name"},countries:{nameField:"name"},sizes:{nameField:"name"},materials:{nameField:"name"},waterproofs:{nameField:"name"},collections:{nameField:"name"},volumes:{nameField:"value"},product_weights:{nameField:"value"},installation_types:{nameField:"name"},shapes:{nameField:"name"},applications:{nameField:"name"},drying_times:{nameField:"name"},package_weights:{nameField:"value"},min_temps:{nameField:"value"},max_temps:{nameField:"value"},consumptions:{nameField:"name"}},F=Object.keys(N),B={category:"categories",brand:"brands",color:"colors",pattern:"patterns",weight:"weights",subcategory:"subcategories",glue:"glues",mixture_type:"mixture_types",seam:"seams",texture:"textures",country:"countries",size:"sizes",material:"materials",waterproof:"waterproofs",collection:"collections",volume:"volumes",product_weight:"product_weights",installation_type:"installation_types",shape:"shapes",application:"applications",drying_time:"drying_times",package_weight:"package_weights",min_temp:"min_temps",max_temp:"max_temps",consumption:"consumptions"},ae=(g,o)=>{let u;return(...e)=>{clearTimeout(u),u=setTimeout(()=>g(...e),o)}},oe=M("category",()=>{const g=y(Object.fromEntries(F.map(t=>[t,[]]))),o=y(Object.fromEntries(F.map(t=>[t,[]]))),u=y(""),e=y(""),_=y("default"),r=y(1),x=v(()=>{const t={...o.value,min_price:u.value,max_price:e.value,sort:_.value,page:r.value};return t.categories&&t.categories.length>0&&(t.category_ids=t.categories,delete t.categories),Object.keys(t).forEach(n=>{const a=t[n];(a===""||a===null||a===void 0||Array.isArray(a)&&a.length===0)&&delete t[n]}),t}),k=v(()=>{const t=[];return F.forEach(n=>{o.value[n].forEach(a=>{const d=g.value[n].find(w=>w.id===a);if(d){const w=N[n];t.push({type:n,id:a,name:d[w.nameField]})}})}),t}),$=t=>{Object.assign(g.value,t)},b=t=>{F.forEach(n=>{o.value[n]=t[n]||[]}),r.value=1},C=ae(b,300),i=t=>{r.value=t},m=t=>{_.value=t,r.value=1},A=(t,n)=>{const a=B[t]||t;o.value[a]&&(o.value[a]=o.value[a].filter(d=>d!==n)),b(o.value)},O=(t,n)=>{const a=B[t]||t;if(o.value[a]){const d=o.value[a].indexOf(n);d===-1?o.value[a].push(n):o.value[a].splice(d,1)}C(o.value)},l=()=>{F.forEach(t=>{o.value[t]=[]}),_.value="default",r.value=1,Object.keys(g.value).forEach(t=>{g.value[t]=[]})},f=Object.fromEntries(F.map(t=>[`selected${t.charAt(0).toUpperCase()+t.slice(1)}`,v(()=>o.value[t])]));return{filters:g,selected:o,minPrice:u,maxPrice:e,sortOption:_,currentPage:r,...f,queryParams:x,selectedFilters:k,setFilters:$,handleFilterChange:b,debouncedHandleFilterChange:C,changePage:i,handleSortChange:m,removeFilter:A,selectFilter:O,resetFilters:l}}),ne={class:"shop-category-area pt-100px pb-100px"},ie={class:"container"},re={class:"row"},le={class:"col-lg-9 order-lg-last col-md-12 order-md-first"},ce={class:"shop-top-bar d-flex justify-content-between mb-3 row"},me={class:"category-text col-sm-12 col-md-6 mb-3 mb-md-0"},ue={key:0,class:"h3 m-0"},pe={key:1},de={key:1,class:"error text-center mt-5"},ge={key:2,class:"text-center mt-2"},_e={key:3,class:"shop-bottom-area"},fe={class:"row"},ve={class:"col"},he={class:"tab-content"},ye={class:"tab-pane fade show active",id:"shop-grid"},Fe={class:"row mb-n-30px"},xe={__name:"[slug]",setup(g){const u=K().params.slug,e=oe();Q(()=>{e.resetFilters()});const _=W(),r=_.public.siteUrl||"https://agatceramic.ru",{data:x,pending:k,error:$,execute:b}=se(`category-products-${u}`,()=>$fetch(`${_.public.apiBase}/api/category/${u}/products`,{query:e.queryParams}),{immediate:!1}),C=()=>b();z(()=>e.queryParams,()=>C(),{immediate:!0});const i=v(()=>x.value?.category||null),m=v(()=>x.value?.products||null);z(x,l=>{l&&l.filters&&e.setFilters(l.filters)},{immediate:!0});const A=v(()=>$.value&&!k.value),O=v(()=>m.value?.data?{"@context":"https://schema.org","@type":"ItemList",name:i.value?.name||"Категория товаров",description:i.value?.description||"",url:`${_.public.siteUrl}/category/${u}`,numberOfItems:m.value.data.length,itemListElement:m.value.data.map((l,f)=>({"@type":"Product",position:f+1,name:l.name,description:l.description,image:l.image,offers:{"@type":"Offer",price:l.price,priceCurrency:"RUB",availability:l.in_stock?"https://schema.org/InStock":"https://schema.org/OutOfStock"}}))}:null);return X(v(()=>({title:i.value?.name?`${i.value.name} - AgatCeramic. Купить в Москве по низкой цене с доставкой`:"Категория товаров - AgatCeramic",meta:[{name:"description",content:i.value?.description||"Купить товары категории в интернет-магазине AgatCeramic"},{name:"keywords",content:i.value?.name?`${i.value.name}, керамическая плитка, сантехника`:"керамическая плитка, сантехника"},{property:"og:image",content:`${r}/images/stock/logo.png`},{property:"og:title",content:"AgatCeramic - Интернет-магазин плитки, керамогранита и сантехники"},{property:"og:description",content:i.value?.description||"Купить товары категории в интернет-магазине AgatCeramic"},{property:"og:url",content:`${r}/category/${u}`},{name:"twitter:image",content:`${r}/images/stock/logo.png`}],link:[{rel:"canonical",href:`${r}/category/${u}`}],script:[...O.value?[{type:"application/ld+json",children:JSON.stringify(O.value)}]:[],{type:"application/ld+json",children:JSON.stringify({"@context":"https://schema.org","@type":"Organization",name:"AgatCeramic",url:r,logo:`${r}/images/stock/logo.png`,description:"Интернет-магазин плитки, керамогранита и сантехники",email:"zakaz@agatceramic.ru",contactPoint:{"@type":"ContactPoint",telephone:"+7 (999) 999-99-99",contactType:"customer service"}})}]}))),(l,f)=>{const t=q,n=I,a=H,d=J,w=V,D=L,R=te;return p(),h("main",ne,[c("div",ie,[P(t,{selectedFilters:s(e).selectedFilters,onRemoveFilter:s(e).removeFilter},null,8,["selectedFilters","onRemoveFilter"]),c("div",re,[c("div",le,[c("div",ce,[c("div",me,[i.value?(p(),h("h1",ue,U(i.value.name),1)):S("",!0),i.value?(p(),h("p",pe,U(i.value.description),1)):S("",!0)]),P(n,{"onUpdate:sortOption":s(e).handleSortChange},null,8,["onUpdate:sortOption"])]),s(k)?(p(),E(a,{key:0,text:"Загрузка товаров..."})):A.value?(p(),h("div",de,[...f[0]||(f[0]=[c("h2",null,[T(" Произошла ошибка при загрузке товаров."),c("br"),T("Попробуйте перезагрузить страницу. ")],-1)])])):!m.value||!m.value.data||m.value.data.length===0?(p(),h("div",ge,[...f[1]||(f[1]=[c("h2",null,"Список товаров пуст",-1)])])):(p(),h("div",_e,[c("div",fe,[c("div",ve,[c("div",he,[c("div",ye,[c("div",Fe,[(p(!0),h(Y,null,Z(m.value.data,j=>(p(),E(d,{key:j.id,product:j},null,8,["product"]))),128))])])])])]),m.value.last_page>1?(p(),E(w,{key:0,"current-page":m.value.current_page,"total-pages":m.value.last_page,onChangePage:s(e).changePage},null,8,["current-page","total-pages","onChangePage"])):S("",!0)]))]),P(R,null,{default:ee(()=>[P(D,{store:s(e),categories:s(e).filters.categories,subcategories:s(e).filters.subcategories,patterns:s(e).filters.patterns,weights:s(e).filters.weights,colors:s(e).filters.colors,glues:s(e).filters.glues,mixture_types:s(e).filters.mixture_types,seams:s(e).filters.seams,textures:s(e).filters.textures,countries:s(e).filters.countries,sizes:s(e).filters.sizes,materials:s(e).filters.materials,waterproofs:s(e).filters.waterproofs,collections:s(e).filters.collections,volumes:s(e).filters.volumes,product_weights:s(e).filters.product_weights,installation_types:s(e).filters.installation_types,shapes:s(e).filters.shapes,applications:s(e).filters.applications,drying_times:s(e).filters.drying_times,package_weights:s(e).filters.package_weights,min_temps:s(e).filters.min_temps,max_temps:s(e).filters.max_temps,consumptions:s(e).filters.consumptions,brands:s(e).filters.brands,initialFilters:s(e).filters},null,8,["store","categories","subcategories","patterns","weights","colors","glues","mixture_types","seams","textures","countries","sizes","materials","waterproofs","collections","volumes","product_weights","installation_types","shapes","applications","drying_times","package_weights","min_temps","max_temps","consumptions","brands","initialFilters"])]),_:1})])])])}}},Pe=G(xe,[["__scopeId","data-v-24722ac8"]]);export{Pe as default};
