import{_ as R}from"./D7avEDMr.js";import{_ as $}from"./Bqof-9AT.js";import{_ as A,E as I,H as S,r as g,d as D,w as E,o as F,A as H,e as u,f as r,j as e,m as y,t as b,x,F as w,k as C,I as f,G as m,s as M}from"#entry";const N={class:"search-page"},V={class:"container"},j={class:"row"},z={class:"col-12"},G={class:"search-header"},L={key:0},O={class:"search-results"},T={key:1,class:"no-results"},U={key:2,class:"shop-bottom-area"},W={class:"row"},J={class:"col"},K={class:"tab-content"},Q={class:"tab-pane fade show active",id:"shop-grid"},X={class:"row mb-n-30px"},Y={key:0,class:"pagination-wrapper"},Z={"aria-label":"Page navigation"},ee={class:"pagination"},te=["onClick"],se={__name:"index",setup(ae){const p=I(),q=S(),B=M(),l=g(""),i=g([]),_=g(!1),s=g({total:0,current_page:1,per_page:24,last_page:1}),P=D(()=>{const t=s.value.current_page,a=s.value.last_page,d=2,v=[],o=[];for(let n=1;n<=a;n++)(n===1||n===a||n>=t-d&&n<=t+d)&&v.push(n);let c=0;for(let n of v)c&&(n-c===2?o.push(c+1):n-c!==1&&o.push("...")),o.push(n),c=n;return o}),k=async()=>{if(l.value){_.value=!0;try{const t=await $fetch(`${B.public.apiBase}/api/search`,{method:"POST",body:{query:l.value,page:s.value.current_page,per_page:s.value.per_page}});i.value=t.products.data||[],s.value={total:t.products.total||0,current_page:t.products.current_page||1,per_page:t.products.per_page||40,last_page:t.products.last_page||1}}catch(t){console.error("Ошибка при поиске товаров:",t),i.value=[]}finally{_.value=!1}}},h=t=>{t<1||t>s.value.last_page||t===s.value.current_page||(s.value.current_page=t,q.push({query:{...p.query,page:t}}))};return E(()=>p.query,t=>{l.value=t.q||"",s.value.current_page=parseInt(t.page)||1,l.value&&k()},{immediate:!0}),F(()=>{l.value=p.query.q||"",s.value.current_page=parseInt(p.query.page)||1,l.value&&k()}),H({title:"Результаты поиска - AgatCeramic",meta:[{name:"robots",content:"noindex, nofollow"}]}),(t,a)=>{const d=R,v=$;return r(),u("div",N,[e("div",V,[e("div",j,[e("div",z,[e("div",G,[a[2]||(a[2]=e("h1",null,"Результаты поиска",-1)),l.value?(r(),u("p",L,'По запросу: "'+b(l.value)+'"',1)):y("",!0)]),e("div",O,[_.value?(r(),x(d,{key:0,text:"Поиск товаров..."})):i.value.length===0&&!_.value?(r(),u("div",T,[...a[3]||(a[3]=[e("div",{class:"no-results-content"},[e("i",{class:"pe-7s-search"}),e("h3",null,"Ничего не найдено"),e("p",null,"Попробуйте изменить поисковый запрос")],-1)])])):(r(),u("div",U,[e("div",W,[e("div",J,[e("div",K,[e("div",Q,[e("div",X,[(r(!0),u(w,null,C(i.value,o=>(r(),x(v,{key:o.id,product:o},null,8,["product"]))),128))])])])])]),i.value.length>0&&s.value.last_page>1?(r(),u("div",Y,[e("nav",Z,[e("ul",ee,[e("li",{class:f(["page-item",{disabled:s.value.current_page===1}])},[e("a",{class:"page-link",href:"#",onClick:a[0]||(a[0]=m(o=>h(s.value.current_page-1),["prevent"]))},[...a[4]||(a[4]=[e("i",{class:"pe-7s-angle-left"},null,-1)])])],2),(r(!0),u(w,null,C(P.value,o=>(r(),u("li",{key:o,class:f(["page-item",{active:o===s.value.current_page}])},[e("a",{class:"page-link",href:"#",onClick:m(c=>h(o),["prevent"])},b(o),9,te)],2))),128)),e("li",{class:f(["page-item",{disabled:s.value.current_page===s.value.last_page}])},[e("a",{class:"page-link",href:"#",onClick:a[1]||(a[1]=m(o=>h(s.value.current_page+1),["prevent"]))},[...a[5]||(a[5]=[e("i",{class:"pe-7s-angle-right"},null,-1)])])],2)])])])):y("",!0)]))])])])])])}}},le=A(se,[["__scopeId","data-v-831703be"]]);export{le as default};
