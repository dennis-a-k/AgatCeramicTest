import{_ as R}from"./J-T6rV--.js";import{_ as $}from"./l5vvTGDd.js";import{_ as S,r as g,j as A,l as D,f as I,B as z,c as u,a as e,s as k,t as b,y as x,F as C,m as q,C as f,A as m,z as F,D as M,o as r}from"#entry";import"./BVOsQ5dV.js";const N={class:"search-page"},V={class:"container"},j={class:"row"},E={class:"col-12"},L={class:"search-header"},O={key:0},T={class:"search-results"},U={key:1,class:"no-results"},W={key:2,class:"shop-bottom-area"},G={class:"row"},H={class:"col"},J={class:"tab-content"},K={class:"tab-pane fade show active",id:"shop-grid"},Q={class:"row mb-n-30px"},X={key:0,class:"pagination-wrapper"},Y={"aria-label":"Page navigation"},Z={class:"pagination"},ee=["onClick"],se={__name:"index",setup(te){const p=z(),w=M(),B=F(),l=g(""),i=g([]),_=g(!1),t=g({total:0,current_page:1,per_page:24,last_page:1}),P=A(()=>{const s=t.value.current_page,a=t.value.last_page,d=2,v=[],o=[];for(let n=1;n<=a;n++)(n===1||n===a||n>=s-d&&n<=s+d)&&v.push(n);let c=0;for(let n of v)c&&(n-c===2?o.push(c+1):n-c!==1&&o.push("...")),o.push(n),c=n;return o}),y=async()=>{if(l.value){_.value=!0;try{const s=await $fetch(`${B.public.apiBase}/api/search`,{method:"POST",body:{query:l.value,page:t.value.current_page,per_page:t.value.per_page}});i.value=s.products.data||[],t.value={total:s.products.total||0,current_page:s.products.current_page||1,per_page:s.products.per_page||40,last_page:s.products.last_page||1}}catch(s){console.error("Ошибка при поиске товаров:",s),i.value=[]}finally{_.value=!1}}},h=s=>{s<1||s>t.value.last_page||s===t.value.current_page||(t.value.current_page=s,w.push({query:{...p.query,page:s}}))};return D(()=>p.query,s=>{l.value=s.q||"",t.value.current_page=parseInt(s.page)||1,l.value&&y()},{immediate:!0}),I(()=>{l.value=p.query.q||"",t.value.current_page=parseInt(p.query.page)||1,l.value&&y()}),(s,a)=>{const d=R,v=$;return r(),u("div",N,[e("div",V,[e("div",j,[e("div",E,[e("div",L,[a[2]||(a[2]=e("h1",null,"Результаты поиска",-1)),l.value?(r(),u("p",O,'По запросу: "'+b(l.value)+'"',1)):k("",!0)]),e("div",T,[_.value?(r(),x(d,{key:0,text:"Поиск товаров..."})):i.value.length===0&&!_.value?(r(),u("div",U,[...a[3]||(a[3]=[e("div",{class:"no-results-content"},[e("i",{class:"pe-7s-search"}),e("h3",null,"Ничего не найдено"),e("p",null,"Попробуйте изменить поисковый запрос")],-1)])])):(r(),u("div",W,[e("div",G,[e("div",H,[e("div",J,[e("div",K,[e("div",Q,[(r(!0),u(C,null,q(i.value,o=>(r(),x(v,{key:o.id,product:o},null,8,["product"]))),128))])])])])]),i.value.length>0&&t.value.last_page>1?(r(),u("div",X,[e("nav",Y,[e("ul",Z,[e("li",{class:f(["page-item",{disabled:t.value.current_page===1}])},[e("a",{class:"page-link",href:"#",onClick:a[0]||(a[0]=m(o=>h(t.value.current_page-1),["prevent"]))},[...a[4]||(a[4]=[e("i",{class:"pe-7s-angle-left"},null,-1)])])],2),(r(!0),u(C,null,q(P.value,o=>(r(),u("li",{key:o,class:f(["page-item",{active:o===t.value.current_page}])},[e("a",{class:"page-link",href:"#",onClick:m(c=>h(o),["prevent"])},b(o),9,ee)],2))),128)),e("li",{class:f(["page-item",{disabled:t.value.current_page===t.value.last_page}])},[e("a",{class:"page-link",href:"#",onClick:a[1]||(a[1]=m(o=>h(t.value.current_page+1),["prevent"]))},[...a[5]||(a[5]=[e("i",{class:"pe-7s-angle-right"},null,-1)])])],2)])])])):k("",!0)]))])])])])])}}},le=S(se,[["__scopeId","data-v-8aef3657"]]);export{le as default};
